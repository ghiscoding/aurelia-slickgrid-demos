"use strict";(self.webpackChunkau_slickgrid_demo=self.webpackChunkau_slickgrid_demo||[]).push([[7662],{7431:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(1601),n=a.n(i),s=a(6314),r=a.n(s)()(n());r.push([e.id,".demo39 .badge{display:none}.demo39 .badge.fully-loaded{display:inline-flex}",""]);const l=r},3521:(e,t,a)=>{var i=a(1601),n=a.n(i),s=a(6314);a.n(s)()(n()).push([e.id,".demo39 .badge{display:none}.demo39 .badge.fully-loaded{display:inline-flex}",""])},5281:(e,t,a)=>{a.r(t),a.d(t,{Example39:()=>T});var i={};a.r(i),a.d(i,{bindables:()=>d,default:()=>l,dependencies:()=>o,name:()=>s,register:()=>u,template:()=>r});var n=a(3680);a(3521);const s="example39",r='<div class="demo39">\n  <h2>\n    Example 39: GraphQL Backend Service with Infinite Scroll\n    <span class="float-end">\n      <a style="font-size: 18px" target="_blank"\n          href="https://github.com/ghiscoding/aurelia-slickgrid/blob/master/packages/demo/src/examples/slickgrid/example39.ts">\n        <span class="mdi mdi-link-variant"></span> code\n      </a>\n    </span>\n  </h2>\n\n  <h6 class="title is-6 italic content">\n    <ul>\n      <li>\n        Infinite scrolling allows the grid to lazy-load rows from the server when reaching the scroll bottom (end) position.\n        In its simplest form, the more the user scrolls down, the more rows get loaded.\n        If we reached the end of the dataset and there is no more data to load, then we\'ll assume to have the entire dataset loaded in memory.\n        This contrast with the regular Pagination approach which will hold only hold data for 1 page at a time.\n      </li>\n      <li>NOTES</li>\n      <ol>\n        <li>\n          <code>presets.pagination</code> is not supported with Infinite Scroll and will revert to the first page,\n          simply because since we keep appending data, we always have to start from index zero (no offset).\n        </li>\n        <li>\n          Pagination is not shown BUT in fact, that is what is being used behind the scene whenever reaching the scroll end (fetching next batch).\n        </li>\n        <li>\n          Also note that whenever the user changes the Sort(s)/Filter(s) it will always reset and go back to zero index (first page).\n        </li>\n      </ol>\n    </ul>\n  </h6>\n\n  <div class="row">\n    <div class="col-sm-5">\n      <div class.bind="status.class" role="alert" data-test="status">\n        <strong>Status: </strong> ${status.text}\n        <span hidden.bind="!processing">\n          <i class="mdi mdi-sync mdi-spin-1s"></i>\n        </span>\n      </div>\n\n      <div class="row">\n        <div class="col-md-12">\n          <button class="btn btn-outline-secondary btn-sm btn-icon" data-test="clear-filters-sorting"\n                  click.trigger="clearAllFiltersAndSorts()" title="Clear all Filters & Sorts">\n            <i class="mdi mdi-filter-remove-outline"></i>\n            Clear all Filter & Sorts\n          </button>\n          <label for="serverdelay" class="ml-4">Server Delay: </label>\n          <input id="serverdelay" type="number" data-test="server-delay" style="width: 55px"\n                value.bind="serverWaitDelay"\n                title="input a fake timer delay to simulate slow server response" />\n        </div>\n      </div>\n\n      <br />\n      <div show.bind="metrics" style="margin: 10px 0px">\n        <b>Metrics:</b>\n        <span>\n        <span>${metrics.endTime | dateFormat: \'DD MMM, h:mm:ss a\'}</span> â€”\n          <span data-test="itemCount">${metrics.itemCount}</span>\n          of\n          <span data-test="totalItemCount">${metrics.totalItemCount}</span>\n          items\n        </span>\n        <span class="badge rounded-pill text-bg-primary" class.bind="tagDataClass" data-test="data-loaded-tag">All Data Loaded!!!</span>\n      </div>\n    </div>\n\n    <div class="col-sm-7">\n      <div class="alert alert-info" data-test="alert-graphql-query">\n        <strong>GraphQL Query:</strong>\n        <div innerhtml.bind="graphqlQuery" data-test="graphql-query-result"></div>\n      </div>\n    </div>\n  </div>\n\n  <aurelia-slickgrid\n    grid-id="grid39"\n    column-definitions.bind="columnDefinitions"\n    grid-options.bind="gridOptions"\n    dataset.bind="dataset"\n    instances.bind="aureliaGrid"\n    on-aurelia-grid-created.trigger="aureliaGridReady($event.detail)"\n    on-row-count-changed.trigger="refreshMetrics($event.detail.args)">\n  </aurelia-slickgrid>\n</div>\n',l=r,o=[],d={};let c;function u(e){c||(c=n.K9.define({name:s,template:r,dependencies:o,bindables:d})),e.register(c)}var h=a(9931),p=a(7557),m=a(7158),g=a(6609),f=a(5072),b=a.n(f),y=a(7825),v=a.n(y),w=a(7659),C=a.n(w),S=a(5056),A=a.n(S),k=a(540),x=a.n(k),L=a(1113),E=a.n(L),D=a(7431),I={};I.styleTagTransform=E(),I.setAttributes=A(),I.insert=C().bind(null,"head"),I.domAPI=v(),I.insertStyleElement=x(),b()(D.A,I),D.A&&D.A.locals&&D.A.locals,a(6757);const G="assets/data",O="users";function P(e){return e.replace(/^"/,"").replace(/"$/,"").toLowerCase()}let T=(()=>{let e,t,a=[(0,n.EM)(i)],s=[];return t=class{constructor(e=(0,p.hd)((0,p.pn)(h.xl))){this.http=e,this.dataset=[],this.tagDataClass="",this.graphqlQuery="...",this.processing=!1,this.status={text:"processing...",class:"alert alert-danger"},this.serverWaitDelay=250,this.backendService=new m.P,this.initializeGrid()}aureliaGridReady(e){this.aureliaGrid=e}initializeGrid(){this.columnDefinitions=[{id:"name",field:"name",nameKey:"NAME",width:60,type:g.PUO.string,sortable:!0,filterable:!0,filter:{model:g.CuW.compoundInput}},{id:"gender",field:"gender",nameKey:"GENDER",filterable:!0,sortable:!0,width:60,filter:{model:g.CuW.singleSelect,collection:[{value:"",label:""},{value:"male",labelKey:"MALE"},{value:"female",labelKey:"FEMALE"}]}},{id:"company",field:"company",nameKey:"COMPANY",width:60,sortable:!0,filterable:!0,filter:{model:g.CuW.multipleSelect,customStructure:{label:"company",value:"company"},collectionSortBy:{property:"company",sortDesc:!1},collectionAsync:this.http.fetch(`${G}/customers_100.json`).then((e=>e.json())),filterOptions:{filter:!0}}}],this.gridOptions={enableAutoResize:!0,autoResize:{container:"#demo-container",rightPadding:10},enableAutoTooltip:!0,autoTooltipOptions:{enableForHeaderCells:!0},enableFiltering:!0,enableCellNavigation:!0,multiColumnSort:!1,gridMenu:{resizeOnShowHeaderRow:!0},backendServiceApi:{disableInternalPostProcess:!0,service:this.backendService,options:{datasetName:O,addLocaleIntoQuery:!0,extraQueryArguments:[{field:"userId",value:123}],infiniteScroll:{fetchSize:30}},preProcess:()=>this.displaySpinner(!0),process:e=>this.getCustomerApiCall(e),postProcess:e=>{this.metrics={endTime:new Date,totalItemCount:e.data[O].totalCount||0},this.displaySpinner(!1),this.getCustomerCallback(e)}}}}clearAllFiltersAndSorts(){this.aureliaGrid?.gridService&&this.aureliaGrid.gridService.clearAllFiltersAndSorts()}displaySpinner(e){this.processing=e,this.status=e?{text:"processing...",class:"alert alert-danger"}:{text:"finished",class:"alert alert-success"}}getCustomerCallback(e){const{nodes:t,totalCount:a}=e.data[O];this.aureliaGrid&&(this.metrics.totalItemCount=a,e.infiniteScrollBottomHit?this.aureliaGrid.dataView?.addItems(t):(this.aureliaGrid.slickGrid?.scrollTo(0),this.dataset=t,this.metrics.itemCount=t.length))}getCustomerApiCall(e){return this.getCustomerDataApiMock(e)}getCustomerDataApiMock(e){return new Promise((t=>{let a=0,i=0,n="",s="";this.http.fetch(`${G}/customers_100.json`).then((e=>e.json())).then((r=>{let l=r;if(e.includes("first:")){const t=e.match(/first:([0-9]+),/)||[];a=+t[1]}if(e.includes("offset:")){const t=e.match(/offset:([0-9]+),/)||[];i=+t[1]}if(e.includes("orderBy:")){const[t,a,i]=/orderBy:\[{field:([a-zA-Z/]+),direction:(ASC|DESC)}\]/gi.exec(e)||[];n=a||"",s=i||""}if(e.includes("orderBy:")){const[t,a,i]=/orderBy:\[{field:([a-zA-Z/]+),direction:(ASC|DESC)}\]/gi.exec(e)||[];n=a||"",s=i||""}if(e.includes("filterBy:")){const t=/{field:(\w+),operator:(\w+),value:([0-9a-z',"\s]*)}/gi;let a;for(;null!==(a=t.exec(e));){const e=a[1]||"",t=a[2]||"",i=a[3]||"";let[n,s]=i.split(",");e&&t&&""!==i&&(l=l.filter((a=>{const r=a[e];switch(n=P(n),s=P(s||""),t){case"EQ":return r.toLowerCase()===n;case"NE":return r.toLowerCase()!==n;case"LE":return r.toLowerCase()<=n;case"LT":return r.toLowerCase()<n;case"GT":return r.toLowerCase()>n;case"GE":return r.toLowerCase()>=n;case"EndsWith":return r.toLowerCase().endsWith(n);case"StartsWith":return r.toLowerCase().startsWith(n);case"Starts+Ends":return r.toLowerCase().startsWith(n)&&r.toLowerCase().endsWith(s);case"Contains":return r.toLowerCase().includes(n);case"Not_Contains":return!r.toLowerCase().includes(n);case"IN":const e=i.toLocaleLowerCase().split(",");for(const t of e)if(r.toLocaleLowerCase()===P(t))return!0}})))}}let o=i;o>l.length&&(e=e.replace(`offset:${o}`,""),o=0);const d=e=>n?e[n]:e;switch(s.toUpperCase()){case"ASC":l=l.sort(((e,t)=>d(e).localeCompare(d(t))));break;case"DESC":l=l.sort(((e,t)=>d(t).localeCompare(d(e))))}const c=l.slice(o,o+a),u={data:{[O]:{nodes:c,totalCount:l.length}}};setTimeout((()=>{this.graphqlQuery=this.gridOptions.backendServiceApi.service.buildQuery(),t(u)}),this.serverWaitDelay)}))}))}refreshMetrics(e){e?.current>=0&&(this.metrics.itemCount=this.aureliaGrid.dataView?.getFilteredItemCount()||0,this.tagDataClass=this.metrics.itemCount===this.metrics.totalItemCount?"fully-loaded":"partial-load")}},r=t,"symbol"==typeof(l="Example39")&&(l=l.description?"[".concat(l.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:o?"".concat(o," ",l):l}),(()=>{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;(function(e,t,a,i,n,s){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,o=i.kind,d="getter"===o?"get":"setter"===o?"set":"value",c=!t&&e?i.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,i.name):{}),h=!1,p=a.length-1;p>=0;p--){var m={};for(var g in i)m[g]="access"===g?{}:i[g];for(var g in i.access)m.access[g]=i.access[g];m.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(r(e||null))};var f=(0,a[p])("accessor"===o?{get:u.get,set:u.set}:u[d],m);if("accessor"===o){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(l=r(f.get))&&(u.get=l),(l=r(f.set))&&(u.set=l),(l=r(f.init))&&n.unshift(l)}else(l=r(f))&&("field"===o?n.unshift(l):u[d]=l)}c&&Object.defineProperty(c,i.name,u),h=!0})(null,e={value:t},a,{kind:"class",name:t.name,metadata:i},null,s),t=e.value,i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i}),function(e,t,a){for(var i=arguments.length>2,n=0;n<t.length;n++)a=i?t[n].call(e,a):t[n].call(e)}(t,s)})(),t;var r,l,o})()}}]);