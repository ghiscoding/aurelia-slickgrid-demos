(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"9Jp8":function(t,i,e){"use strict";e.d(i,"a",(function(){return s}));var r=e("MG25");class n{constructor(t,i){if(this.queryFnName=t,this.head=[],"string"==typeof i)this.alias=i;else if("object"==typeof i)this.filter(i);else{if(void 0===i&&2===arguments.length)throw new TypeError('You have passed undefined as Second argument to "Query"');if(void 0!==i)throw new TypeError('Second argument to "Query" should be an alias name(String) or filter arguments(Object). What was passed is: '+i)}}filter(t){for(const i of Object.keys(t)){if("function"==typeof t[i])continue;const e=this.getGraphQLValue(t[i]);"{}"!==e&&this.head.push(`${i}:${e}`)}return this}find(...t){if(!t||!Array.isArray(t)||0===t.length)throw new TypeError("find value can not be >>falsy<<");const i=1===t.length&&Array.isArray(t[0])?t[0]:t;return this.body=this.parceFind(i),this}setAlias(t){this.alias=t}toString(){if(void 0===this.body)throw new ReferenceError("return properties are not defined. use the 'find' function to defined them");return`${this.alias?this.alias+":":""} ${this.queryFnName} ${this.head.length>0?"("+this.head.join(",")+")":""}  { ${this.body} }`}parceFind(t){return t.map((i,e)=>{const r=t[e];if(r instanceof n)return r.toString();if(Array.isArray(r)||"object"!=typeof r){if("string"==typeof r)return r;throw new RangeError("cannot handle Find value of "+r)}{const t=Object.keys(r);if(1!==t.length)throw new RangeError("Alias objects should only have one value. was passed: "+JSON.stringify(r));const i=t[0],e=r[i];return Array.isArray(e)?new n(i).find(e):`${i} : ${e} `}}).join(",")}getGraphQLValue(t){return"string"==typeof t?t=JSON.stringify(t):Array.isArray(t)?t=`[${t=t.map(t=>this.getGraphQLValue(t)).join()}]`:t instanceof Date?t=JSON.stringify(t):null!==t&&"object"==typeof t&&(t=this.objectToString(t)),t}objectToString(t){const i=[];for(const e of Object.keys(t))"function"!=typeof t[e]&&i.push(`${e}:${this.getGraphQLValue(t[e])}`);return`{${i.join()}}`}}class s{constructor(){this._currentFilters=[],this._currentSorters=[],this._datasetIdPropName="id",this.defaultPaginationOptions={first:25,offset:0}}get columnDefinitions(){return this._columnDefinitions}get _gridOptions(){var t;return(null===(t=this._grid)||void 0===t?void 0:t.getOptions)?this._grid.getOptions():{}}init(t,i,e){this._grid=e,this.options=t||{datasetName:""},this.pagination=i,this._datasetIdPropName=this._gridOptions.datasetIdPropertyName||"id",e&&e.getColumns&&(this._columnDefinitions=e.getColumns()||[])}buildQuery(){var t;if(!this.options||!this.options.datasetName||!Array.isArray(this._columnDefinitions))throw new Error('GraphQL Service requires the "datasetName" property to properly build the GraphQL query');let i=this._columnDefinitions||[];i=i.filter(t=>!t.excludeFromQuery);const e=new n("query"),r=new n(this.options.datasetName),s=new n("nodes"),o=[];if(i&&Array.isArray(i))for(const t of i)o.push(t.field),t.fields&&o.push(...t.fields);-1===o.indexOf(this._datasetIdPropName)&&o.unshift(this._datasetIdPropName);const a=this.buildFilterQuery(o);let l=[];if(!1!==this._gridOptions.enablePagination){if(this.options.isWithCursor){const t=new n("edges"),i=new n("pageInfo");i.find("hasNextPage","hasPreviousPage","endCursor","startCursor"),s.find(a),t.find(["cursor"]),l=["totalCount",s,i,t]}else s.find(a),l=["totalCount",s];r.find(l)}else r.find(a);let p={};if(!1!==this._gridOptions.enablePagination&&(p=Object.assign(Object.assign({},this.options.paginationOptions),{first:(this.options.paginationOptions&&this.options.paginationOptions.first?this.options.paginationOptions.first:this.pagination&&this.pagination.pageSize?this.pagination.pageSize:null)||this.defaultPaginationOptions.first}),this.options.isWithCursor||(p.offset=this.options.paginationOptions&&this.options.paginationOptions.hasOwnProperty("offset")?+this.options.paginationOptions.offset:0)),this.options.sortingOptions&&Array.isArray(this.options.sortingOptions)&&this.options.sortingOptions.length>0&&(p.orderBy=this.options.sortingOptions),this.options.filteringOptions&&Array.isArray(this.options.filteringOptions)&&this.options.filteringOptions.length>0&&(p.filterBy=this.options.filteringOptions),this.options.addLocaleIntoQuery&&(p.locale=(null===(t=this._gridOptions.translater)||void 0===t?void 0:t.getCurrentLanguage())||this._gridOptions.locale||"en"),this.options.extraQueryArguments)for(const t of this.options.extraQueryArguments)p[t.field]=t.value;r.filter(p),e.find(r);return this.trimDoubleQuotesOnEnumField(e.toString(),["direction:","field:","operator:"],this.options.keepArgumentFieldDoubleQuotes||!1)}buildFilterQuery(t){const i=(t={},e)=>{const r=e.shift();return t[r]=e.length?i(t[r],e):null,t},e=t.reduce((t,e)=>i(t,e.split(".")),{});return JSON.stringify(e).replace(/\"|\:|null/g,"").replace(/^\{/,"").replace(/\}$/,"")}clearFilters(){this._currentFilters=[],this.updateOptions({filteringOptions:[]})}clearSorters(){this._currentSorters=[],this.updateOptions({sortingOptions:[]})}getInitPaginationOptions(){var t;const i=this.pagination?this.pagination.pageSize:25;return(null===(t=this.options)||void 0===t?void 0:t.isWithCursor)?{first:i}:{first:i,offset:0}}getDatasetName(){var t;return(null===(t=this.options)||void 0===t?void 0:t.datasetName)||""}getCurrentFilters(){return this._currentFilters}getCurrentPagination(){return this._currentPagination}getCurrentSorters(){return this._currentSorters}resetPaginationOptions(){let t;this.options&&this.options.isWithCursor?t={after:"",before:void 0,last:void 0}:(t=this.options&&this.options.paginationOptions||this.getInitPaginationOptions(),t.offset=0),this._currentPagination={pageNumber:1,pageSize:t.first||20},!this._gridOptions||!this._gridOptions.enablePagination&&this._gridOptions.hasOwnProperty("enablePagination")||this.updateOptions({paginationOptions:t})}updateOptions(t){this.options=Object.assign(Object.assign({},this.options),t)}processOnFilterChanged(t,i){if(void 0===this._gridOptions.backendServiceApi)throw new Error('Something went wrong in the GraphqlService, "backendServiceApi" is not initialized');if(this._currentFilters=this.castFilterToColumnFilters(i.columnFilters),!i||!i.grid)throw new Error('Something went wrong when trying create the GraphQL Backend Service, it seems that "args" is not populated correctly');return this.updateFilters(i.columnFilters,!1),this.resetPaginationOptions(),this.buildQuery()}processOnPaginationChanged(t,i){const e=+(i.pageSize||(this.pagination?this.pagination.pageSize:20));return this.updatePagination(i.newPage,e),this.buildQuery()}processOnSortChanged(t,i){const e=i.multiColumnSort?i.sortCols:new Array({columnId:i.sortCol.id,sortCol:i.sortCol,sortAsc:i.sortAsc});return this.updateSorters(e),this.buildQuery()}updateFilters(t,i){var e,n;const s=[];let o;i&&(this._currentFilters=this.castFilterToColumnFilters(t));for(const a in t)if(t.hasOwnProperty(a)){const l=t[a];let p;if(p=i&&Array.isArray(this._columnDefinitions)?this._columnDefinitions.find(t=>t.id===l.columnId):l.columnDef,!p)throw new Error("[GraphQL Service]: Something went wrong in trying to get the column definition of the specified filter (or preset filters). Did you make a typo on the filter columnId?");const u=(null===(e=p.filter)||void 0===e?void 0:e.queryField)||p.queryFieldFilter||p.queryField||p.field||p.name||"",h=p.type||r.L.string;let d=null!==(n=null==l?void 0:l.searchTerms)&&void 0!==n?n:[],c=Array.isArray(d)&&1===d.length?d[0]:"";if(void 0===c&&(c=""),!u)throw new Error('GraphQL filter could not find the field name to query the search, your column definition must include a valid "field" or "name" (optionally you can also use the "queryfield").');c=""+c;const g=c.match(/^([<>!=\*]{0,2})(.*[^<>!=\*])([\*]?)$/);let f=l.operator||(g?g[1]:"");o=g?g[2]:"";const y=g?g[3]:"*z"===f?"*":"";if(u&&""===o&&0===d.length)continue;if(Array.isArray(d)&&1===d.length&&"string"==typeof d[0]&&d[0].indexOf("..")>=0&&(f||(f=this._gridOptions.defaultFilterRangeOperator),d=d[0].split("..",2),""===d[0]?(f=f===r.sb.rangeInclusive?"<=":f===r.sb.rangeExclusive?"<":f,d=d.slice(1),o=d[0]):""===d[1]&&(f=f===r.sb.rangeInclusive?">=":f===r.sb.rangeExclusive?">":f,d=d.slice(0,1),o=d[0])),"string"==typeof o&&("*"!==f&&"a*"!==f&&"*z"!==f&&"*"!==y||(f="*"===f||"*z"===f?"EndsWith":"StartsWith")),!f&&p.filter&&p.filter.operator&&(f=p.filter.operator),!f&&Array.isArray(d)&&2===d.length&&d[0]&&d[1]&&(f=this._gridOptions.defaultFilterRangeOperator),(f===r.sb.rangeInclusive||r.sb.rangeExclusive)&&Array.isArray(d)&&1===d.length&&h===r.L.date&&(f=r.sb.equal),o=this.normalizeSearchValue(h,o),Array.isArray(d)&&d.forEach((t,i)=>{d[i]=this.normalizeSearchValue(h,d[i])}),d&&d.length>1&&("IN"===f||"NIN"===f||"NOT_IN"===f))o=d.join(",");else if(d&&2===d.length&&(f===r.sb.rangeExclusive||f===r.sb.rangeInclusive)){s.push({field:u,operator:f===r.sb.rangeInclusive?"GE":"GT",value:d[0]}),s.push({field:u,operator:f===r.sb.rangeInclusive?"LE":"LT",value:d[1]});continue}f||(f=Object(r.Wc)(h)),s.push({field:u,operator:Object(r.Yc)(f),value:o})}this.updateOptions({filteringOptions:s})}updatePagination(t,i){let e;this._currentPagination={pageNumber:t,pageSize:i},e=this.options&&this.options.isWithCursor?{first:i}:{first:i,offset:t>1?(t-1)*i:0},this.updateOptions({paginationOptions:e})}updateSorters(t,i){let e=[];const n=[];if(!t&&i){e=i,e.forEach(t=>t.direction=t.direction.toUpperCase());const t=e.map(t=>{const i=this._columnDefinitions.find(i=>i.id===t.columnId);return n.push({field:i?(i.queryFieldSorter||i.queryField||i.field)+"":t.columnId+"",direction:t.direction}),i?{columnId:t.columnId,sortAsc:t.direction.toUpperCase()===r.Hb.ASC}:null});Array.isArray(t)&&this._grid&&this._grid.setSortColumns(t.filter(t=>t)||[])}else if(t&&!i&&Array.isArray(t)&&t.length>0)for(const i of t)if(i&&i.sortCol){e.push({columnId:i.sortCol.id+"",direction:i.sortAsc?r.Hb.ASC:r.Hb.DESC});const t=(i.sortCol.queryFieldSorter||i.sortCol.queryField||i.sortCol.field||"")+"";t&&n.push({field:t,direction:i.sortAsc?r.Hb.ASC:r.Hb.DESC})}this._currentSorters=e,this.updateOptions({sortingOptions:n})}trimDoubleQuotesOnEnumField(t,i,e){let r=i.join('s?((field:s*)?".*?")|');r+='s?((field:s*)?".*?")';const n=new RegExp(r,"g");return t.replace(n,t=>{let i=!0;t.startsWith("field:")&&e&&(i=!1);return i?t.replace(/"/g,""):t})}castFilterToColumnFilters(t){const i="object"==typeof t?Object.keys(t).map(i=>t[i]):t;return Array.isArray(i)?i.map(t=>{const i={columnId:t.columnId||""};return t.operator&&(i.operator=t.operator),Array.isArray(t.searchTerms)&&(i.searchTerms=t.searchTerms),i}):[]}normalizeSearchValue(t,i){switch(t){case r.L.date:case r.L.string:case r.L.text:case r.L.readonly:"string"==typeof i&&(i=i.replace(/'/g,"''"));break;case r.L.integer:case r.L.number:case r.L.float:"string"==typeof i&&(""!==(i=(i=(i=(i=(i=i.replace(/\.\./g,".")).replace(/\.+$/g,"")).replace(/^\.+/g,"0.")).replace(/^\-+\.+/g,"-0.")).replace(/(?!^\-)[^\d\.]/g,""))&&"-"!==i||(i="0"))}return i}}}}]);
//# sourceMappingURL=vendors~b6ef8688.2c24dc8749deb0aec88e.bundle.map