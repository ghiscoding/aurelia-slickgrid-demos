"use strict";(self.webpackChunkau_slickgrid_demo=self.webpackChunkau_slickgrid_demo||[]).push([[2268],{69861(e,t,r){r.d(t,{$:()=>Y,L:()=>le,_u:()=>te,yU:()=>oe});var s={},i=Uint8Array,o=Uint16Array,l=Int32Array,n=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=function(e,t){for(var r=new o(31),s=0;s<31;++s)r[s]=t+=1<<e[s-1];var i=new l(r[30]);for(s=1;s<30;++s)for(var n=r[s];n<r[s+1];++n)i[n]=n-r[s]<<5|s;return{b:r,r:i}},c=d(n,2),p=c.b,u=c.r;p[28]=258,u[258]=28;for(var m=d(a,0),f=(m.b,m.r),g=new o(32768),x=0;x<32768;++x){var b=(43690&x)>>1|(21845&x)<<1;b=(61680&(b=(52428&b)>>2|(13107&b)<<2))>>4|(3855&b)<<4,g[x]=((65280&b)>>8|(255&b)<<8)>>1}var y=function(e,t,r){for(var s=e.length,i=0,l=new o(t);i<s;++i)e[i]&&++l[e[i]-1];var n,a=new o(t);for(i=1;i<t;++i)a[i]=a[i-1]+l[i-1]<<1;if(r){n=new o(1<<t);var h=15-t;for(i=0;i<s;++i)if(e[i])for(var d=i<<4|e[i],c=t-e[i],p=a[e[i]-1]++<<c,u=p|(1<<c)-1;p<=u;++p)n[g[p]>>h]=d}else for(n=new o(s),i=0;i<s;++i)e[i]&&(n[i]=g[a[e[i]-1]++]>>15-e[i]);return n},C=new i(288);for(x=0;x<144;++x)C[x]=8;for(x=144;x<256;++x)C[x]=9;for(x=256;x<280;++x)C[x]=7;for(x=280;x<288;++x)C[x]=8;var w=new i(32);for(x=0;x<32;++x)w[x]=5;var _=y(C,9,0),v=y(w,5,0),E=function(e){return(e+7)/8|0},S=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new i(e.subarray(t,r))},T=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(e,t,r){var s=new Error(t||T[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,F),!r)throw s;return s},A=function(e,t,r){r<<=7&t;var s=t/8|0;e[s]|=r,e[s+1]|=r>>8},k=function(e,t,r){r<<=7&t;var s=t/8|0;e[s]|=r,e[s+1]|=r>>8,e[s+2]|=r>>16},O=function(e,t){for(var r=[],s=0;s<e.length;++s)e[s]&&r.push({s,f:e[s]});var l=r.length,n=r.slice();if(!l)return{t:L,l:0};if(1==l){var a=new i(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var h=r[0],d=r[1],c=0,p=1,u=2;for(r[0]={s:-1,f:h.f+d.f,l:h,r:d};p!=l-1;)h=r[r[c].f<r[u].f?c++:u++],d=r[c!=p&&r[c].f<r[u].f?c++:u++],r[p++]={s:-1,f:h.f+d.f,l:h,r:d};var m=n[0].s;for(s=1;s<l;++s)n[s].s>m&&(m=n[s].s);var f=new o(m+1),g=P(r[p-1],f,0);if(g>t){s=0;var x=0,b=g-t,y=1<<b;for(n.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));s<l;++s){var C=n[s].s;if(!(f[C]>t))break;x+=y-(1<<g-f[C]),f[C]=t}for(x>>=b;x>0;){var w=n[s].s;f[w]<t?x-=1<<t-f[w]++-1:++s}for(;s>=0&&x;--s){var _=n[s].s;f[_]==t&&(--f[_],++x)}g=t}return{t:new i(f),l:g}},P=function(e,t,r){return-1==e.s?Math.max(P(e.l,t,r+1),P(e.r,t,r+1)):t[e.s]=r},D=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new o(++t),s=0,i=e[0],l=1,n=function(e){r[s++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++l;else{if(!i&&l>2){for(;l>138;l-=138)n(32754);l>2&&(n(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(n(i),--l;l>6;l-=6)n(8304);l>2&&(n(l-3<<5|8208),l=0)}for(;l--;)n(i);l=1,i=e[a]}return{c:r.subarray(0,s),n:t}},I=function(e,t){for(var r=0,s=0;s<t.length;++s)r+=e[s]*t[s];return r},N=function(e,t,r){var s=r.length,i=E(t+2);e[i]=255&s,e[i+1]=s>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<s;++o)e[i+o+4]=r[o];return 8*(i+4+s)},$=function(e,t,r,s,i,l,d,c,p,u,m){A(t,m++,r),++i[256];for(var f=O(i,15),g=f.t,x=f.l,b=O(l,15),E=b.t,S=b.l,T=D(g),F=T.c,P=T.n,$=D(E),R=$.c,L=$.n,M=new o(19),z=0;z<F.length;++z)++M[31&F[z]];for(z=0;z<R.length;++z)++M[31&R[z]];for(var B=O(M,7),H=B.t,j=B.l,G=19;G>4&&!H[h[G-1]];--G);var V,X,W,U,Q=u+5<<3,q=I(i,C)+I(l,w)+d,J=I(i,g)+I(l,E)+d+14+3*G+I(M,H)+2*M[16]+3*M[17]+7*M[18];if(p>=0&&Q<=q&&Q<=J)return N(t,m,e.subarray(p,p+u));if(A(t,m,1+(J<q)),m+=2,J<q){V=y(g,x,0),X=g,W=y(E,S,0),U=E;var Y=y(H,j,0);for(A(t,m,P-257),A(t,m+5,L-1),A(t,m+10,G-4),m+=14,z=0;z<G;++z)A(t,m+3*z,H[h[z]]);m+=3*G;for(var K=[F,R],Z=0;Z<2;++Z){var ee=K[Z];for(z=0;z<ee.length;++z){var te=31&ee[z];A(t,m,Y[te]),m+=H[te],te>15&&(A(t,m,ee[z]>>5&127),m+=ee[z]>>12)}}}else V=_,X=C,W=v,U=w;for(z=0;z<c;++z){var re=s[z];if(re>255){k(t,m,V[257+(te=re>>18&31)]),m+=X[te+257],te>7&&(A(t,m,re>>23&31),m+=n[te]);var se=31&re;k(t,m,W[se]),m+=U[se],se>3&&(k(t,m,re>>5&8191),m+=a[se])}else k(t,m,V[re]),m+=X[re]}return k(t,m,V[256]),m+X[256]},R=new l([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new i(0),M=function(e,t,r,s,h,d){var c=d.z||e.length,p=new i(s+c+5*(1+Math.ceil(c/7e3))+h),m=p.subarray(s,p.length-h),g=d.l,x=7&(d.r||0);if(t){x&&(m[0]=d.r>>3);for(var b=R[t-1],y=b>>13,C=8191&b,w=(1<<r)-1,_=d.p||new o(32768),v=d.h||new o(w+1),T=Math.ceil(r/3),F=2*T,A=function(t){return(e[t]^e[t+1]<<T^e[t+2]<<F)&w},k=new l(25e3),O=new o(288),P=new o(32),D=0,I=0,L=d.i||0,M=0,z=d.w||0,B=0;L+2<c;++L){var H=A(L),j=32767&L,G=v[H];if(_[j]=G,v[H]=j,z<=L){var V=c-L;if((D>7e3||M>24576)&&(V>423||!g)){x=$(e,m,0,k,O,P,I,M,B,L-B,x),M=D=I=0,B=L;for(var X=0;X<286;++X)O[X]=0;for(X=0;X<30;++X)P[X]=0}var W=2,U=0,Q=C,q=j-G&32767;if(V>2&&H==A(L-q))for(var J=Math.min(y,V)-1,Y=Math.min(32767,L),K=Math.min(258,V);q<=Y&&--Q&&j!=G;){if(e[L+W]==e[L+W-q]){for(var Z=0;Z<K&&e[L+Z]==e[L+Z-q];++Z);if(Z>W){if(W=Z,U=q,Z>J)break;var ee=Math.min(q,Z-2),te=0;for(X=0;X<ee;++X){var re=L-q+X&32767,se=re-_[re]&32767;se>te&&(te=se,G=re)}}}q+=(j=G)-(G=_[j])&32767}if(U){k[M++]=268435456|u[W]<<18|f[U];var ie=31&u[W],oe=31&f[U];I+=n[ie]+a[oe],++O[257+ie],++P[oe],z=L+W,++D}else k[M++]=e[L],++O[e[L]]}}for(L=Math.max(L,z);L<c;++L)k[M++]=e[L],++O[e[L]];x=$(e,m,g,k,O,P,I,M,B,L-B,x),g||(d.r=7&x|m[x/8|0]<<3,x-=7,d.h=v,d.p=_,d.i=L,d.w=z)}else{for(L=d.w||0;L<c+g;L+=65535){var le=L+65535;le>=c&&(m[x/8|0]=g,le=c),x=N(m,x+1,e.subarray(L,le))}d.i=c}return S(p,0,s+E(x)+h)},z=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,s=9;--s;)r=(1&r&&-306674912)^r>>>1;e[t]=r}return e}(),B=function(){var e=-1;return{p:function(t){for(var r=e,s=0;s<t.length;++s)r=z[255&r^t[s]]^r>>>8;e=r},d:function(){return~e}}},H=function(){var e=1,t=0;return{p:function(r){for(var s=e,i=t,o=0|r.length,l=0;l!=o;){for(var n=Math.min(l+2655,o);l<n;++l)i+=s+=r[l];s=(65535&s)+15*(s>>16),i=(65535&i)+15*(i>>16)}e=s,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},j=function(e,t,r,s,o){if(!o&&(o={l:1},t.dictionary)){var l=t.dictionary.subarray(-32768),n=new i(l.length+e.length);n.set(l),n.set(e,l.length),e=n,o.w=l.length}return M(e,null==t.level?6:t.level,null==t.mem?o.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,s,o)},G=function(e,t){var r={};for(var s in e)r[s]=e[s];for(var s in t)r[s]=t[s];return r},V=function(e,t,r){for(var s=e(),i=e.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),l=0;l<s.length;++l){var n=s[l],a=o[l];if("function"==typeof n){t+=";"+a+"=";var h=n.toString();if(n.prototype)if(-1!=h.indexOf("[native code]")){var d=h.indexOf(" ",8)+1;t+=h.slice(d,h.indexOf("(",d))}else for(var c in t+=h,n.prototype)t+=";"+a+".prototype."+c+"="+n.prototype[c].toString();else t+=h}else r[a]=n}return t},X=[],W=function(){return[i,o,l,n,a,h,u,f,_,C,v,w,g,R,L,y,A,k,O,P,D,I,N,$,E,S,M,j,J,U]},U=function(e){return postMessage(e,[e.buffer])},Q=function(e,t,r,i,o,l){var n=function(e,t,r,i){if(!X[r]){for(var o="",l={},n=e.length-1,a=0;a<n;++a)o=V(e[a],o,l);X[r]={c:V(e[n],o,l),e:l}}var h=G({},X[r].e);return function(e,t,r,i,o){var l=new Worker(s[t]||(s[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return l.onmessage=function(e){var t=e.data,r=t.$e$;if(r){var s=new Error(r[0]);s.code=r[1],s.stack=r[2],o(s,null)}else o(null,t)},l.postMessage(r,i),l}(X[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,h,function(e){var t=[];for(var r in e)e[r].buffer&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(h),i)}(r,i,o,(function(e,t){n.terminate(),l(e,t)}));return n.postMessage([e,t],t.consume?[e.buffer]:[]),function(){n.terminate()}},q=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8};function J(e,t){return j(e,t||{},0,0)}function Y(e,t){t||(t={});var r=H();r.p(e);var s=j(e,t,t.dictionary?6:2,4);return function(e,t){var r=t.level,s=0==r?0:r<6?1:9==r?3:2;if(e[0]=120,e[1]=s<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=H();i.p(t.dictionary),q(e,2,i.d())}}(s,t),q(s,s.length-4,r.d()),s}var K=function(e,t,r,s){for(var o in e){var l=e[o],n=t+o,a=s;Array.isArray(l)&&(a=G(s,l[1]),l=l[0]),l instanceof i?r[n]=[l,a]:(r[n+="/"]=[new i(0),a],K(l,n,r,s))}},Z="undefined"!=typeof TextEncoder&&new TextEncoder,ee="undefined"!=typeof TextDecoder&&new TextDecoder;try{ee.decode(L,{stream:!0})}catch(e){}function te(e,t){if(t){for(var r=new i(e.length),s=0;s<e.length;++s)r[s]=e.charCodeAt(s);return r}if(Z)return Z.encode(e);var o=e.length,l=new i(e.length+(e.length>>1)),n=0,a=function(e){l[n++]=e};for(s=0;s<o;++s){if(n+5>l.length){var h=new i(n+8+(o-s<<1));h.set(l),l=h}var d=e.charCodeAt(s);d<128||t?a(d):d<2048?(a(192|d>>6),a(128|63&d)):d>55295&&d<57344?(a(240|(d=65536+(1047552&d)|1023&e.charCodeAt(++s))>>18),a(128|d>>12&63),a(128|d>>6&63),a(128|63&d)):(a(224|d>>12),a(128|d>>6&63),a(128|63&d))}return S(l,0,n)}var re=function(e){var t=0;if(e)for(var r in e){var s=e[r].length;s>65535&&F(9),t+=s+4}return t},se=function(e,t,r,s,i,o,l,n){var a=s.length,h=r.extra,d=n&&n.length,c=re(h);q(e,t,null!=l?33639248:67324752),t+=4,null!=l&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(o<0&&8),e[t++]=i&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),u=p.getFullYear()-1980;if((u<0||u>119)&&F(10),q(e,t,u<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>1),t+=4,-1!=o&&(q(e,t,r.crc),q(e,t+4,o<0?-o-2:o),q(e,t+8,r.size)),q(e,t+12,a),q(e,t+14,c),t+=16,null!=l&&(q(e,t,d),q(e,t+6,r.attrs),q(e,t+10,l),t+=14),e.set(s,t),t+=a,c)for(var m in h){var f=h[m],g=f.length;q(e,t,+m),q(e,t+2,g),e.set(f,t+4),t+=4+g}return d&&(e.set(n,t),t+=d),t},ie=function(e,t,r,s,i){q(e,t,101010256),q(e,t+8,r),q(e,t+10,r),q(e,t+12,s),q(e,t+16,i)};function oe(e,t,r){r||(r=t,t={}),"function"!=typeof r&&F(7);var s={};K(e,"",s,t);var o=Object.keys(s),l=o.length,n=0,a=0,h=l,d=new Array(l),c=[],p=function(){for(var e=0;e<c.length;++e)c[e]()},u=function(e,t){ne((function(){r(e,t)}))};ne((function(){u=r}));var m=function(){var e=new i(a+22),t=n,r=a-n;a=0;for(var s=0;s<h;++s){var o=d[s];try{var l=o.c.length;se(e,a,o,o.f,o.u,l);var c=30+o.f.length+re(o.extra),p=a+c;e.set(o.c,p),se(e,n,o,o.f,o.u,l,a,o.m),n+=16+c+(o.m?o.m.length:0),a=p+l}catch(e){return u(e,null)}}ie(e,n,d.length,r,t),u(null,e)};l||m();for(var f=function(e){var t=o[e],r=s[t],i=r[0],h=r[1],f=B(),g=i.length;f.p(i);var x=te(t),b=x.length,y=h.comment,C=y&&te(y),w=C&&C.length,_=re(h.extra),v=0==h.level?0:8,E=function(r,s){if(r)p(),u(r,null);else{var i=s.length;d[e]=G(h,{size:g,crc:f.d(),c:s,f:x,m:C,u:b!=t.length||C&&y.length!=w,compression:v}),n+=30+b+_+i,a+=76+2*(b+_)+(w||0)+i,--l||m()}};if(b>65535&&E(F(11,0,1),null),v)if(g<16e4)try{E(null,J(i,h))}catch(e){E(e,null)}else c.push(function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&F(7),Q(e,t,[W],(function(e){return U(J(e.data[0],e.data[1]))}),0,r)}(i,h,E));else E(null,i)},g=0;g<h;++g)f(g);return p}function le(e,t){t||(t={});var r={},s=[];K(e,"",r,t);var o=0,l=0;for(var n in r){var a=r[n],h=a[0],d=a[1],c=0==d.level?0:8,p=(E=te(n)).length,u=d.comment,m=u&&te(u),f=m&&m.length,g=re(d.extra);p>65535&&F(11);var x=c?J(h,d):h,b=x.length,y=B();y.p(h),s.push(G(d,{size:h.length,crc:y.d(),c:x,f:E,m,u:p!=n.length||m&&u.length!=f,o,compression:c})),o+=30+p+g+b,l+=76+2*(p+g)+(f||0)+b}for(var C=new i(l+22),w=o,_=l-o,v=0;v<s.length;++v){var E=s[v];se(C,E.o,E,E.f,E.u,E.c.length);var S=30+E.f.length+re(E.extra);C.set(E.c,E.o+S),se(C,o,E,E.f,E.u,E.c.length,E.o,E.m),o+=16+S+(E.m?E.m.length:0)}return ie(C,o,s.length,_,w),C}var ne="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(e){e()}},32268(e,t,r){r.d(t,{N:()=>M});var s=r(40296),i=r(21322),o=r(69861);function l(e){let t=typeof e;return null!=e&&("object"===t||"function"===t)}function n(e){if("object"!=typeof e||!e||"[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);if(null===t)return!0;let r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(e)}function a(e){return null!=e&&"string"==typeof e.valueOf()}var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};const d=e=>("string"!=typeof e&&(e=`${e}`),e.replace(/[&<>"']/g,(e=>h[e])));var c=class{documentElement;constructor(e,t){this.documentElement=this.createElement(t),this.documentElement.setAttribute("xmlns",e)}createElement(e){return new u({nodeName:e})}createTextNode(e){return new p(e)}toString(){return this.documentElement.toString()}static Node={Create:e=>{switch(e.type){case"XML":return new u(e);case"TEXT":return new p(e.nodeValue);default:return null}}}},p=class{nodeValue;constructor(e){this.nodeValue=e}toJSON(){return{nodeValue:this.nodeValue,type:"TEXT"}}toString(){return d(this.nodeValue)}},u=class e{nodeName;children;nodeValue;attributes;firstChild;constructor(e){if(this.nodeName=e.nodeName,this.children=[],this.nodeValue=e.nodeValue||"",this.attributes={},e.children)for(let t=0,r=e.children.length;t<r;t++)this.appendChild(c.Node.Create(e.children[t]));if(e.attributes)for(let[t,r]of Object.entries(e.attributes))this.setAttribute(t,r)}toString(){let e=`<${this.nodeName}`;for(let t in this.attributes)this.attributes.hasOwnProperty(t)&&(e=`${e} ${t}="${d(this.attributes[t])}"`);let t="";for(let e=0,r=this.children.length;e<r;e++)t+=this.children[e].toString();return e+=t?`>${t}</${this.nodeName}>`:"/>",e}toJSON(){let e=[];for(let t=0,r=this.children.length;t<r;t++)e.push(this.children[t].toJSON());return{nodeName:this.nodeName,children:e,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}}setAttribute(e,t){if(null===t)return delete this.attributes[e],void delete this[e];this.attributes[e]=t,this[e]=t}appendChild(e){this.children.push(e),this.firstChild=this.children[0]}cloneNode(t){return new e(this.toJSON())}},m=class e{static _idSpaces={};static uniqueId(t){return e._idSpaces[t]||(e._idSpaces[t]=1),e._idSpaces[t]++}static createXmlDoc(e,t){return new c(e||null,t)}static createElement(e,t,r){let s=e.createElement(t);r||=[];let i=r.length;for(;i--;)s.setAttribute(r[i][0],r[i][1]);return s}static setAttributesOnDoc(e,t){for(let[r,s]of Object.entries(t))n(s)&&(null!==s.v&&void 0!==s.v?s.type===Boolean&&(s=s.v?"1":"0"):s=null),null!=s&&e.setAttribute(r,s)}static LETTER_REFS={};static positionToLetterRef(t,r){let s,i=1,o=t,l="";if(e.LETTER_REFS[t])return e.LETTER_REFS[t].concat(r);for(;o>0;)o-=26**(i-1),s=o%26**i,o-=s,s/=26**(i-1),l="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(s)+l,i+=1;return e.LETTER_REFS[t]=l,l.concat(String(r))}static schemas={worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}},f={};function g(e="$lodash$"){f[e]||(f[e]=0);let t=++f[e];return"$lodash$"===e?`${t}`:`${e}${t}`}const x={};var b=class{relations={};lastId=1;constructor(){g("rId")}importData(e){this.relations=e.relations,this.lastId=e.lastId}exportData(){return{relations:this.relations,lastId:this.lastId}}addRelation(e,t){return this.relations[e.id]={id:g("rId"),schema:m.schemas[t],object:e},this.relations[e.id].id}getRelationshipId(e){return this.relations[e.id]?this.relations[e.id].id:null}toXML(){let e=m.createXmlDoc(m.schemas.relationshipPackage,"Relationships"),t=e.documentElement;for(let[r,s]of Object.entries(this.relations)){let i=m.createElement(e,"Relationship",[["Id",s.id],["Type",s.schema],["Target",s.object.target||x[r]]]);s.object.targetMode&&i.setAttribute("TargetMode",s.object.targetMode),t.appendChild(i)}return e}},y=class{state=null;xSplit=null;ySplit=null;activePane="bottomRight";topLeftCell=null;_freezePane;freezePane(e,t,r){this._freezePane={xSplit:e,ySplit:t,cell:r}}exportXML(e){let t=e.createElement("pane");return null!==this.state&&(t.setAttribute("xSplit",this._freezePane.xSplit),t.setAttribute("ySplit",this._freezePane.ySplit),t.setAttribute("topLeftCell",this._freezePane.cell),t.setAttribute("activePane","bottomRight"),t.setAttribute("state","frozen")),t}},C=class{strings={};stringArray=[];id=g("SharedStrings");addString(e){return this.strings[e]=this.stringArray.length,this.stringArray[this.stringArray.length]=e,this.strings[e]}exportData(){return this.strings}toXML(){let e=m.createXmlDoc(m.schemas.spreadsheetml,"sst"),t=e.documentElement;this.stringArray.reverse();let r=this.stringArray.length;t.setAttribute("count",r),t.setAttribute("uniqueCount",r);let s=e.createElement("si"),i=e.createElement("t");i.appendChild(e.createTextNode("--placeholder--")),s.appendChild(i);let o=this.stringArray;for(;r--;){let e=s.cloneNode(!0);"string"==typeof o[r]&&o[r].match(/\s+/)&&e.firstChild.setAttribute("xml:space","preserve"),e.firstChild.firstChild.nodeValue=o[r],t.appendChild(e)}return e}},w=class{pane;showZeros=null;defaultGridColor=null;colorId=null;rightToLeft=null;showFormulas=null;showGridLines=null;showOutlineSymbols=null;showRowColHeaders=null;showRuler=null;showWhiteSpace=null;tabSelected=null;topLeftCell=null;viewType=null;windowProtection=null;zoomScale=null;zoomScaleNormal=null;zoomScalePageLayoutView=null;zoomScaleSheetLayoutView=null;constructor(e){this.pane=(e||{}).pane||new y}freezePane(e,t,r){this.pane.state="frozen",this.pane.xSplit=e,this.pane.ySplit=t,this.pane.topLeftCell=r}exportXML(e){let t=e.createElement("sheetViews"),r=e.createElement("sheetView");return m.setAttributesOnDoc(r,{workbookViewId:0,showZeros:{v:this.showZeros,type:Boolean},defaultGridColor:{v:this.defaultGridColor,type:Boolean},colorId:this.colorId,rightToLeft:{v:this.rightToLeft,type:Boolean},showFormulas:{v:this.showFormulas,type:Boolean},showGridLines:{v:this.showGridLines,type:Boolean},showOutlineSymbols:{v:this.showOutlineSymbols,type:Boolean},showRowColHeaders:{v:this.showRowColHeaders,type:Boolean},showRuler:{v:this.showRuler,type:Boolean},showWhiteSpace:{v:this.showWhiteSpace,type:Boolean},tabSelected:{v:this.tabSelected,type:Boolean},viewType:this.viewType,windowProtection:{v:this.windowProtection,type:Boolean},zoomScale:{v:this.zoomScale,type:Boolean},zoomScaleNormal:this.zoomScaleNormal,zoomScalePageLayoutView:this.zoomScalePageLayoutView,zoomScaleSheetLayoutView:this.zoomScaleSheetLayoutView}),r.appendChild(this.pane.exportXML(e)),t.appendChild(r),t}},_=class{id=g("StyleSheet");cellStyles=[{name:"Normal",xfId:"0",builtinId:"0"}];defaultTableStyle=!1;differentialStyles=[{}];masterCellFormats=[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}];masterCellStyles=[{numFmtId:0,fontId:0,fillId:0,borderId:0}];fonts=[{}];numberFormatters=[];fills=[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}];borders=[{top:{},left:{},right:{},bottom:{},diagonal:{}}];tableStyles=[];createSimpleFormatter(e){let t={id:this.masterCellFormats.length};return"date"===e&&(t.numFmtId=14),this.masterCellFormats.push(t),t}createFill(e){let t=this.fills.length,r=e;return r.id=t,this.fills.push(r),r}createNumberFormatter(e){let t={id:this.numberFormatters.length+100,formatCode:e};return this.numberFormatters.push(t),t}createFormat(e){let t={id:this.masterCellFormats.length};if(e.protection&&(t.protection=e.protection),e.font&&l(e.font))t.fontId=this.createFontStyle(e.font).id;else if(e.font){if(Number.isNaN(Number.parseInt(e.font,10)))throw Error("Passing a non-numeric font id is not supported");t.fontId=e.font}if(e.format&&a(e.format))t.numFmtId=this.createNumberFormatter(e.format).id;else if(e.format){if(Number.isNaN(Number.parseInt(e.format,10)))throw Error("Invalid number formatter id");t.numFmtId=e.format}if(e.border&&l(e.border))t.borderId=this.createBorderFormatter(e.border).id;else if(e.border){if(Number.isNaN(Number.parseInt(e.border,10)))throw Error("Passing a non-numeric border id is not supported");t.borderId=e.border}if(e.fill&&l(e.fill))t.fillId=this.createFill(e.fill).id;else if(e.fill){if(Number.isNaN(Number.parseInt(e.fill,10)))throw Error("Passing a non-numeric fill id is not supported");t.fillId=e.fill}return e.alignment&&l(e.alignment)&&(t.alignment=function(e){return["horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText"].reduce(((t,r)=>(e?.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}(e.alignment)),this.masterCellFormats.push(t),t}createDifferentialStyle(e){let t=this.differentialStyles.length,r={id:t};return e.font&&l(e.font)&&(r.font=e.font),e.border&&l(e.border)&&(r.border=Object.assign({top:{},left:{},right:{},bottom:{},diagonal:{}},e.border)),e.fill&&l(e.fill)&&(r.fill=e.fill),e.alignment&&l(e.alignment)&&(r.alignment=e.alignment),e.format&&a(e.format)&&(r.numFmt=e.format),this.differentialStyles[t]=r,r}createTableStyle(e){this.tableStyles.push(e)}createBorderFormatter(e){return e={top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length,...e},this.borders.push(e),e}createFontStyle(e){let t={id:this.fonts.length};return e.bold&&(t.bold=!0),e.italic&&(t.italic=!0),e.superscript&&(t.vertAlign="superscript"),e.subscript&&(t.vertAlign="subscript"),e.underline&&("string"==typeof e.underline&&["double","singleAccounting","doubleAccounting"].includes(e.underline)?t.underline=e.underline:t.underline=!0),e.strike&&(t.strike=!0),e.outline&&(t.outline=!0),e.shadow&&(t.shadow=!0),e.size&&(t.size=e.size),e.color&&(t.color=e.color),e.fontName&&(t.fontName=e.fontName),this.fonts.push(t),t}exportBorders(e){let t=e.createElement("borders");t.setAttribute("count",this.borders.length);for(let r=0,s=this.borders.length;r<s;r++)t.appendChild(this.exportBorder(e,this.borders[r]));return t}exportBorder(e,t){let r=e.createElement("border"),s=r=>{let s=e.createElement(r);return t[r].style&&s.setAttribute("style",t[r].style),t[r].color&&s.appendChild(this.exportColor(e,t[r].color)),s};return r.appendChild(s("left")),r.appendChild(s("right")),r.appendChild(s("top")),r.appendChild(s("bottom")),r.appendChild(s("diagonal")),r}exportColor(e,t){let r=e.createElement("color");return a(t)?(r.setAttribute("rgb",t),r):(void 0!==t.tint&&r.setAttribute("tint",t.tint),void 0!==t.auto&&r.setAttribute("auto",String(!!t.auto)),void 0!==t.theme&&r.setAttribute("theme",t.theme),r)}exportMasterCellFormats(e){let t=m.createElement(e,"cellXfs",[["count",this.masterCellFormats.length]]);for(let r=0,s=this.masterCellFormats.length;r<s;r++){let s=this.masterCellFormats[r];t.appendChild(this.exportCellFormatElement(e,s))}return t}exportMasterCellStyles(e){let t=m.createElement(e,"cellStyleXfs",[["count",this.masterCellStyles.length]]);for(let r=0,s=this.masterCellStyles.length;r<s;r++){let s=this.masterCellStyles[r];t.appendChild(this.exportCellFormatElement(e,s))}return t}exportCellFormatElement(e,t){let r=e.createElement("xf"),s=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],i=Object.keys(t).filter((e=>-1!==s.indexOf(e)));if(t.alignment){let s=t.alignment;r.appendChild(this.exportAlignment(e,s))}t.protection&&(r.appendChild(this.exportProtection(e,t.protection)),r.setAttribute("applyProtection","1"));let o=i.length;for(;o--;)r.setAttribute(i[o],t[i[o]]);return t.fillId&&r.setAttribute("applyFill","1"),t.fontId&&r.setAttribute("applyFont","1"),t.borderId&&r.setAttribute("applyBorder","1"),t.alignment&&r.setAttribute("applyAlignment","1"),t.numFmtId&&r.setAttribute("applyNumberFormat","1"),void 0!==t.numFmtId&&void 0===t.xfId&&r.setAttribute("xfId","0"),r}exportAlignment(e,t){let r=e.createElement("alignment"),s=Object.keys(t);for(let e=0,i=s.length;e<i;e++)r.setAttribute(s[e],t[s[e]]);return r}exportFonts(e){let t=e.createElement("fonts");t.setAttribute("count",String(this.fonts.length));for(let r=0,s=this.fonts.length;r<s;r++){let s=this.fonts[r];t.appendChild(this.exportFont(e,s))}return t}exportFont(e,t){let r=e.createElement("font");if(t.size){let s=e.createElement("sz");s.setAttribute("val",t.size),r.appendChild(s)}if(t.fontName){let s=e.createElement("name");s.setAttribute("val",t.fontName),r.appendChild(s)}if(t.bold&&r.appendChild(e.createElement("b")),t.italic&&r.appendChild(e.createElement("i")),t.vertAlign){let s=e.createElement("vertAlign");s.setAttribute("val",t.vertAlign),r.appendChild(s)}if(t.underline){let s=e.createElement("u");!0!==t.underline&&s.setAttribute("val",t.underline),r.appendChild(s)}return t.strike&&r.appendChild(e.createElement("strike")),t.shadow&&r.appendChild(e.createElement("shadow")),t.outline&&r.appendChild(e.createElement("outline")),t.color&&r.appendChild(this.exportColor(e,t.color)),r}exportFills(e){let t=e.createElement("fills");t.setAttribute("count",String(this.fills.length));for(let r=0,s=this.fills.length;r<s;r++){let s=this.fills[r];t.appendChild(this.exportFill(e,s))}return t}exportFill(e,t){let r,s=e.createElement("fill");return"pattern"===t.type?(r=this.exportPatternFill(e,t),s.appendChild(r)):"gradient"===t.type&&(r=this.exportGradientFill(e,t),s.appendChild(r)),s}exportGradientFill(e,t){let r=e.createElement("gradientFill");t.degree?r.setAttribute("degree",t.degree):t.left&&(r.setAttribute("left",t.left),r.setAttribute("right",t.right),r.setAttribute("top",t.top),r.setAttribute("bottom",t.bottom));let s=e.createElement("stop");s.setAttribute("position",t.start.pureAt||0);let i=e.createElement("color");"string"==typeof t.start||t.start.color?i.setAttribute("rgb",t.start.color||t.start):t.start.theme&&i.setAttribute("theme",t.start.theme);let o=e.createElement("stop"),l=e.createElement("color");return o.setAttribute("position",t.end.pureAt||1),"string"==typeof t.start||t.end.color?l.setAttribute("rgb",t.end.color||t.end):t.end.theme&&l.setAttribute("theme",t.end.theme),s.appendChild(i),o.appendChild(l),r.appendChild(s),r.appendChild(o),r}exportPatternFill(e,t){let r=m.createElement(e,"patternFill",[["patternType",t.patternType]]);t.bgColor||="FFFFFFFF",t.fgColor||="FFFFFFFF";let s=e.createElement("bgColor");a(t.bgColor)?s.setAttribute("rgb",t.bgColor):t.bgColor.theme?s.setAttribute("theme",t.bgColor.theme):s.setAttribute("rgb",t.bgColor.rbg);let i=e.createElement("fgColor");return a(t.fgColor)?i.setAttribute("rgb",t.fgColor):t.fgColor.theme?i.setAttribute("theme",t.fgColor.theme):i.setAttribute("rgb",t.fgColor.rbg),r.appendChild(i),r.appendChild(s),r}exportNumberFormatters(e){let t=e.createElement("numFmts");t.setAttribute("count",String(this.numberFormatters.length));for(let r=0,s=this.numberFormatters.length;r<s;r++){let s=this.numberFormatters[r];t.appendChild(this.exportNumberFormatter(e,s))}return t}exportNumberFormatter(e,t){let r=e.createElement("numFmt");return r.setAttribute("numFmtId",t.id),r.setAttribute("formatCode",t.formatCode),r}exportCellStyles(e){let t=e.createElement("cellStyles");t.setAttribute("count",String(this.cellStyles.length));for(let r=0,s=this.cellStyles.length;r<s;r++){let s=this.cellStyles[r];delete s.id;let i=m.createElement(e,"cellStyle");t.appendChild(i);let o=Object.keys(s),l=o.length;for(;l--;)i.setAttribute(o[l],s[o[l]])}return t}exportDifferentialStyles(e){let t=e.createElement("dxfs");t.setAttribute("count",String(this.differentialStyles.length));for(let r=0,s=this.differentialStyles.length;r<s;r++){let s=this.differentialStyles[r];t.appendChild(this.exportDFX(e,s))}return t}exportDFX(e,t){let r=e.createElement("dxf");return t.font&&r.appendChild(this.exportFont(e,t.font)),t.fill&&r.appendChild(this.exportFill(e,t.fill)),t.border&&r.appendChild(this.exportBorder(e,t.border)),t.numFmt&&r.appendChild(this.exportNumberFormatter(e,t.numFmt)),t.alignment&&r.appendChild(this.exportAlignment(e,t.alignment)),r}exportTableStyles(e){let t=e.createElement("tableStyles");t.setAttribute("count",String(this.tableStyles.length)),this.defaultTableStyle&&t.setAttribute("defaultTableStyle",String(this.defaultTableStyle));for(let r=0,s=this.tableStyles.length;r<s;r++)t.appendChild(this.exportTableStyle(e,this.tableStyles[r]));return t}exportTableStyle(e,t){let r=e.createElement("tableStyle");r.setAttribute("name",t.name),r.setAttribute("pivot","0");let s=0;return Object.entries(t).forEach((([t,i])=>{if("name"===t)return;s++;let o=e.createElement("tableStyleElement");o.setAttribute("type",t),o.setAttribute("dxfId",i),r.appendChild(o)})),r.setAttribute("count",String(s)),r}exportProtection(e,t){let r=e.createElement("protection");for(let e in t)e in t&&r.setAttribute(e,t[e]);return r}toXML(){let e=m.createXmlDoc(m.schemas.spreadsheetml,"styleSheet"),t=e.documentElement;return t.appendChild(this.exportNumberFormatters(e)),t.appendChild(this.exportFonts(e)),t.appendChild(this.exportFills(e)),t.appendChild(this.exportBorders(e)),t.appendChild(this.exportMasterCellStyles(e)),t.appendChild(this.exportMasterCellFormats(e)),t.appendChild(this.exportCellStyles(e)),t.appendChild(this.exportDifferentialStyles(e)),this.tableStyles.length&&t.appendChild(this.exportTableStyles(e)),e}},v=class{name="";id=g("Worksheet");_timezoneOffset;relations=null;columnFormats=[];data=[];mergedCells=[];columns=[];sheetProtection=!1;_headers=[];_footers=[];_tables=[];_drawings=[];_orientation;_margin;_rowInstructions={};_freezePane={};sharedStrings=null;hyperlinks=[];sheetView;showZeros=null;constructor(e){this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.sheetView=e.sheetView||new w,this.initialize(e)}initialize(e){e||={},this.name=e.name,this.id=g("Worksheet"),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,e.columns&&this.setColumns(e.columns),this.relations=new b}exportData(){return{relations:this.relations?.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,_freezePane:this._freezePane,name:this.name,id:this.id}}importData(e){this.relations?.importData(e.relations),delete e.relations,Object.assign(this,e)}setSharedStringCollection(e){this.sharedStrings=e}addTable(e){this._tables.push(e),this.relations?.addRelation(e,"table")}addDrawings(e){this._drawings.push(e),this.relations?.addRelation(e,"drawingRelationship")}setRowInstructions(e,t){this._rowInstructions[e]=t}setHeader(e){if(!Array.isArray(e))throw Error("Invalid argument type - setHeader expects an array of three instructions");this._headers=e}setFooter(e){if(!Array.isArray(e))throw Error("Invalid argument type - setFooter expects an array of three instructions");this._footers=e}compilePageDetailPackage(e){return e||="",["&L",this.compilePageDetailPiece(e[0]||""),"&C",this.compilePageDetailPiece(e[1]||""),"&R",this.compilePageDetailPiece(e[2]||"")].join("")}compilePageDetailPiece(e){if(a(e))return`&"-,Regular"${e}`;if(l(e)&&!Array.isArray(e)){let t="";if(e.font||e.bold){let r=e.bold?"Bold":"Regular";t+=`&"${e.font||"-"}`,t+=`,${r}"`}else t+='&"-,Regular"';return e.underline&&(t+="&U"),e.fontSize&&(t+=`&${e.fontSize}`),t+=e.text,t}return Array.isArray(e)?e.reduce(((e,t)=>e.concat(this.compilePageDetailPiece(t))),""):void 0}exportHeader(e){let t=e.createElement("oddHeader");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._headers))),t}exportFooter(e){let t=e.createElement("oddFooter");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._footers))),t}_buildCache(e){let t=e.createElement("c"),r=e.createElement("v");r.appendChild(e.createTextNode("--temp--")),t.appendChild(r);let s=e.createElement("c"),i=e.createElement("f");i.appendChild(e.createTextNode("--temp--")),s.appendChild(i);let o=e.createElement("c");o.setAttribute("t","s");let l=e.createElement("v");return l.appendChild(e.createTextNode("--temp--")),o.appendChild(l),{number:t,date:t,string:o,formula:s}}collectSharedStrings(){let e=this.data,t=0,r={};for(let s=0,i=e.length;s<i;s++){let i=e[s],o=i.length;t=o>t?o:t;for(let e=0;e<o;e++){let t=i[e],s=t?.metadata||{};t&&"object"==typeof t&&(t=t.value),s.type||"number"==typeof t&&(s.type="number"),("text"===s.type||!s.type)&&void 0===r[t]&&(r[t]=!0)}}return Object.keys(r)}toXML(){let e,t,r,s=this.data,i=this.columns||[],o=m.createXmlDoc(m.schemas.spreadsheetml,"worksheet"),l=o.documentElement;l.setAttribute("xmlns:r",m.schemas.relationships),l.setAttribute("xmlns:mc",m.schemas.markupCompat);let n=0,a=m.createElement(o,"sheetData"),h=this._buildCache(o);for(r=0,t=s.length;r<t;r++){let e=s[r],t=e.length;n=t>n?t:n;let l=o.createElement("row");for(let s=0;s<t;s++){i[s]=i[s]||{};let t,o=e[s],n=o?.metadata||{};switch(o&&"object"==typeof o&&(o=o.value),n.type||"number"==typeof o&&(n.type="number"),n.type){case"number":t=h.number.cloneNode(!0),t.firstChild.firstChild.nodeValue=o;break;case"date":t=h.date.cloneNode(!0),o instanceof Date&&(o=o.getTime()),t.firstChild.firstChild.nodeValue=25569+(o-this._timezoneOffset)/864e5;break;case"formula":t=h.formula.cloneNode(!0),t.firstChild.firstChild.nodeValue=o;break;default:{let e;e=void 0===this.sharedStrings?.strings[o]?this.sharedStrings?.addString(o):this.sharedStrings.strings[o],t=h.string.cloneNode(!0),t.firstChild.firstChild.nodeValue=e;break}}n.style?t.setAttribute("s",n.style):void 0!==this._rowInstructions[r]?.style&&t.setAttribute("s",this._rowInstructions[r].style),t.setAttribute("r",m.positionToLetterRef(s+1,String(r+1))),l.appendChild(t)}if(l.setAttribute("r",r+1),this._rowInstructions[r]){let e=this._rowInstructions[r];void 0!==e.height&&(l.setAttribute("customHeight","1"),l.setAttribute("ht",e.height)),void 0!==e.style&&(l.setAttribute("customFormat","1"),l.setAttribute("s",e.style))}a.appendChild(l)}if(0===n?l.appendChild(m.createElement(o,"dimension",[["ref",m.positionToLetterRef(1,1)]])):l.appendChild(m.createElement(o,"dimension",[["ref",`${m.positionToLetterRef(1,1)}:${m.positionToLetterRef(n,String(s.length))}`]])),l.appendChild(this.sheetView.exportXML(o)),this.columns.length&&l.appendChild(this.exportColumns(o)),l.appendChild(a),this.sheetProtection&&l.appendChild(this.sheetProtection.exportXML(o)),this.hyperlinks.length>0){let r=o.createElement("hyperlinks"),s=this.hyperlinks;for(e=0,t=s.length;e<t;e++){let t=o.createElement("hyperlink"),i=s[e];t.setAttribute("ref",String(i.cell)),i.id=m.uniqueId("hyperlink"),this.relations&&(this.relations.addRelation({id:i.id,target:i.location,targetMode:i.targetMode||"External"},"hyperlink"),t.setAttribute("r:id",this.relations.getRelationshipId(i))),r.appendChild(t)}l.appendChild(r)}if(this.mergedCells.length>0){let r=o.createElement("mergeCells");for(e=0,t=this.mergedCells.length;e<t;e++){let t=o.createElement("mergeCell");t.setAttribute("ref",`${this.mergedCells[e][0]}:${this.mergedCells[e][1]}`),r.appendChild(t)}l.appendChild(r)}if(this.exportPageSettings(o,l),this._headers.length>0||this._footers.length>0){let e=o.createElement("headerFooter");this._headers.length>0&&e.appendChild(this.exportHeader(o)),this._footers.length>0&&e.appendChild(this.exportFooter(o)),l.appendChild(e)}for(e=0,t=this._drawings.length;e<t;e++){let t=o.createElement("drawing");this.relations&&t.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[e])),l.appendChild(t)}if(this._tables.length>0){let r=o.createElement("tableParts");for(r.setAttribute("count",this._tables.length),e=0,t=this._tables.length;e<t;e++){let t=o.createElement("tablePart");this.relations&&t.setAttribute("r:id",this.relations.getRelationshipId(this._tables[e])),r.appendChild(t)}l.appendChild(r)}return o}exportColumns(e){let t=m.createElement(e,"cols");for(let r=0,s=this.columns.length;r<s;r++){let s=this.columns[r],i=m.createElement(e,"col",[["min",s.min||r+1],["max",s.max||r+1]]);s.hidden&&i.setAttribute("hidden","1"),s.bestFit&&i.setAttribute("bestFit","1"),(s.customWidth||s.width)&&i.setAttribute("customWidth","1"),s.width?i.setAttribute("width",s.width):i.setAttribute("width","9.140625"),t.appendChild(i)}return t}exportPageSettings(e,t){if(this._margin){let r=.7,s=this._margin.left?this._margin.left:r,i=this._margin.right?this._margin.right:r,o=this._margin.top?this._margin.top:r,l=this._margin.bottom?this._margin.bottom:r;r=.3;let n=this._margin.header?this._margin.header:r,a=this._margin.footer?this._margin.footer:r;t.appendChild(m.createElement(e,"pageMargins",[["top",o],["bottom",l],["left",s],["right",i],["header",n],["footer",a]]))}this._orientation&&t.appendChild(m.createElement(e,"pageSetup",[["orientation",this._orientation]]))}setPageOrientation(e){this._orientation=e}setPageMargin(e){this._margin=e}setColumns(e){this.columns=e}setData(e){this.data=e}mergeCells(e,t){this.mergedCells.push([e,t])}freezePane(e,t,r){this.sheetView.freezePane(e,t,r)}setColumnFormats(e){this.columnFormats=e}getWorksheetXmlHeader(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<worksheet xmlns="${m.schemas.spreadsheetml}"\n           xmlns:r="${m.schemas.relationships}"\n           xmlns:mc="${m.schemas.markupCompat}">`}getWorksheetXmlFooter(){if(this._headers.length>0||this._footers.length>0){let e="<headerFooter>";return this._headers.length>0&&(e+=`<oddHeader>${this.compilePageDetailPackage(this._headers)}</oddHeader>`),this._footers.length>0&&(e+=`<oddFooter>${this.compilePageDetailPackage(this._footers)}</oddFooter>`),e+="</headerFooter>",e}return""}serializeRows(e,t=0){let r="";for(let s=0,i=e.length;s<i;s++){let i=e[s],o=i.length,l=`<row r="${t+s+1}">`;for(let e=0;e<o;e++){let r=i[e],o=typeof r||"text",n="",a=` r="${String.fromCharCode(65+e)}${t+s+1}"`;switch(o){case"number":n=`<c${a}><v>${r}</v></c>`;break;default:{let e;e=void 0===this.sharedStrings?.strings[r]?this.sharedStrings?.addString(r):this.sharedStrings.strings[r],n=`<c${a} t="s"><v>${e}</v></c>`;break}}l+=n}l+="</row>",r+=l}return r}},E=class{id=g("Workbook");styleSheet=new _;sharedStrings=new C;relations=new b;worksheets=[];charts=[];tables=[];drawings=[];media={};printTitles;constructor(){this.initialize()}initialize(){this.id=g("Workbook"),this.styleSheet=new _,this.sharedStrings=new C,this.relations=new b,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")}createWorksheet(e){return e=Object.assign({},{name:`Sheet ${this.worksheets.length+1}`},e),new v(e)}getStyleSheet(){return this.styleSheet}addTable(e){this.tables.push(e)}addDrawings(e){this.drawings.push(e)}addChart(e){e.index=this.charts.length+1,e.target=`../charts/chart${e.index}.xml`,this.charts.push(e)}setPrintTitleTop(e,t){this.printTitles??={},this.printTitles[e]??(this.printTitles[e]={}),this.printTitles[e].top=t}setPrintTitleLeft(e,t){this.printTitles??={},this.printTitles[e]??(this.printTitles[e]={}),this.printTitles[e].left=String.fromCharCode(64+t)}addMedia(e,t,r,s){let i=t.split("."),o=i[i.length-1];return s||={jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",gif:"image/gif"}[o.toLowerCase()]??null,this.media[t]||(this.media[t]={id:t,data:r,fileName:t,contentType:s,extension:o}),this.media[t]}addWorksheet(e){this.relations.addRelation(e,"worksheet"),e.setSharedStringCollection(this.sharedStrings),this.worksheets.push(e)}createContentTypes(){let e,t,r=m.createXmlDoc(m.schemas.contentTypes,"Types"),s=r.documentElement;s.appendChild(m.createElement(r,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),s.appendChild(m.createElement(r,"Default",[["Extension","xml"],["ContentType","application/xml"]]));let i={};for(let e in this.media)i[this.media[e].extension]=this.media[e].contentType;for(let e in i)s.appendChild(m.createElement(r,"Default",[["Extension",e],["ContentType",i[e]]]));for(s.appendChild(m.createElement(r,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),s.appendChild(m.createElement(r,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),s.appendChild(m.createElement(r,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),e=0,t=this.worksheets.length;e<t;e++)s.appendChild(m.createElement(r,"Override",[["PartName",`/xl/worksheets/sheet${e+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(e=0,t=this.tables.length;e<t;e++)s.appendChild(m.createElement(r,"Override",[["PartName",`/xl/tables/table${e+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(e=0,t=this.drawings.length;e<t;e++)s.appendChild(m.createElement(r,"Override",[["PartName",`/xl/drawings/drawing${e+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));for(e=0,t=this.charts.length;e<t;e++)s.appendChild(m.createElement(r,"Override",[["PartName",`/xl/charts/chart${e+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawingml.chart+xml"]]));return r}toXML(){let e=m.createXmlDoc(m.schemas.spreadsheetml,"workbook"),t=e.documentElement;t.setAttribute("xmlns:r",m.schemas.relationships);let r=m.createElement(e,"sheets");for(let t=0,s=this.worksheets.length;t<s;t++){let s=e.createElement("sheet");typeof console<"u"&&this.worksheets[t].name.length>31&&console.log(`Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "${this.worksheets[t].name}" is ${this.worksheets[t].name.length} characters long`),s.setAttribute("name",this.worksheets[t].name),s.setAttribute("sheetId",t+1),s.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[t])),r.appendChild(s)}t.appendChild(r);let s=m.createElement(e,"definedNames"),i=0;for(let t in this.printTitles)if(t in this.printTitles){let r=this.printTitles[t],o=e.createElement("definedName");o.setAttribute("name","_xlnm.Print_Titles"),o.setAttribute("localSheetId",i++);let l="";r.top&&(l+=`${t}!$1:$${r.top}`,r.left&&(l+=",")),r.left&&(l+=`${t}!$A:$${r.left}`),o.appendChild(e.createTextNode(l)),s.appendChild(o)}return t.appendChild(s),e}createWorkbookRelationship(){let e=m.createXmlDoc(m.schemas.relationshipPackage,"Relationships");return e.documentElement.appendChild(m.createElement(e,"Relationship",[["Id","rId1"],["Type",m.schemas.officeDocument],["Target","xl/workbook.xml"]])),e}_generateCorePaths(e){let t,r;for(x[this.styleSheet.id]="styles.xml",x[this.sharedStrings.id]="sharedStrings.xml",x[this.id]="/xl/workbook.xml",t=0,r=this.tables.length;t<r;t++)e[`/xl/tables/table${t+1}.xml`]=this.tables[t].toXML(),x[this.tables[t].id]=`/xl/tables/table${t+1}.xml`;for(let t in this.media){let r=this.media[t];e[`/xl/media/${t}`]=r.data,x[t]=`/xl/media/${t}`}for(t=0,r=this.drawings.length;t<r;t++)e[`/xl/drawings/drawing${t+1}.xml`]=this.drawings[t].toXML(),x[this.drawings[t].id]=`/xl/drawings/drawing${t+1}.xml`,e[`/xl/drawings/_rels/drawing${t+1}.xml.rels`]=this.drawings[t].relations.toXML();for(t=0,r=this.charts.length;t<r;t++)e[`/xl/charts/chart${t+1}.xml`]=this.charts[t].toChartSpaceXML(),x[this.charts[t].id]=`/xl/charts/chart${t+1}.xml`}_prepareFilesForPackaging(e){Object.assign(e,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()});for(let[t,r]of Object.entries(e))if(-1!==t.indexOf(".xml")||-1!==t.indexOf(".rels")){e[t]=r instanceof c?r.toString():r.xml||(new window.XMLSerializer).serializeToString(r);let s=e[t].replace(/xmlns=""/g,"");s=s.replace(/NS[\d]+:/g,""),s=s.replace(/xmlns:NS[\d]+=""/g,""),e[t]=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n${s}`}}generateFiles(){let e={};this._generateCorePaths(e);for(let t=0,r=this.worksheets.length;t<r;t++){let r=this.worksheets[t].toXML();e[`/xl/worksheets/sheet${t+1}.xml`]=r,x[this.worksheets[t].id]=`worksheets/sheet${t+1}.xml`,e[`/xl/worksheets/_rels/sheet${t+1}.xml.rels`]=this.worksheets[t].relations?.toXML()}return this._prepareFilesForPackaging(e),Promise.resolve(e)}serializeHeader(){return'<?xml version="1.0" encoding="UTF-8"?><workbook>'}serializeFooter(){return"</workbook>"}};function S(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t+"=".repeat((4-t.length%4)%4),s=atob(r);return Uint8Array.from(s,(e=>e.charCodeAt(0)))}const T=(e,{excelFormatId:t})=>void 0!==t?{value:e,metadata:{style:t}}:e,F=(e,{columnDef:t,excelFormatId:r,gridOptions:s})=>({value:"string"==typeof e&&/\d/g.test(e)?A(e,t,s):e,metadata:{style:r}});function A(e,t,r){let i=e;if("string"==typeof e&&e){const o=","===(0,s.Nv7)("decimalSeparator",t,r,s.YMJ.DEFAULT_NUMBER_DECIMAL_SEPARATOR)?parseFloat(e.replace(/[^0-9,-]+/g,"").replace(",",".")):parseFloat(e.replace(/[^\d.-]/g,""));i=isNaN(o)?e:o}return i}function k(e,t,r,i,o=!0){const l=(0,s.lB_)(r);let n,a=T;return l===s.PUO.number&&o&&(n=D(e,t,r,i,"cell").excelFormat.id,a=F),{excelFormatId:n,getDataValueParser:a}}function O(e,t){return e?.[t.groupType]?.[t.columnDef.field]??0}function P(e){let t;switch(e){case s._tQ.currency:case s._tQ.dollar:case s._tQ.dollarColored:case s._tQ.dollarColoredBold:t="currency";break;case s._tQ.percent:case s._tQ.percentComplete:case s._tQ.percentCompleteBar:case s._tQ.percentCompleteBarWithText:case s._tQ.percentSymbol:t="percent";break;case s._tQ.decimal:default:t="decimal"}return t}function D(e,t,r,i,o){let l,n="",a=r.groupTotalsExcelExportOptions?.groupType||"";const h=(0,s.lB_)(r);if("group"===o)switch(r.groupTotalsFormatter){case s.tao.avgTotals:case s.tao.avgTotalsCurrency:case s.tao.avgTotalsDollar:case s.tao.avgTotalsPercentage:a="avg";break;case s.tao.minTotals:a="min";break;case s.tao.maxTotals:a="max";break;case s.tao.sumTotals:case s.tao.sumTotalsBold:case s.tao.sumTotalsColored:case s.tao.sumTotalsCurrency:case s.tao.sumTotalsCurrencyColored:case s.tao.sumTotalsDollar:case s.tao.sumTotalsDollarColoredBold:case s.tao.sumTotalsDollarColored:case s.tao.sumTotalsDollarBold:a="sum";break;default:l=t.numberFormat}else if(h===s.PUO.number)switch(r.formatter){case s._tQ.multiple:if(Array.isArray(r.params?.formatters))for(const s of r.params.formatters){const{excelFormat:n}=D(e,t,{...r,formatter:s},i,o);if(n!==t.numberFormat){l=n;break}}l||(l=t.numberFormat);break;case s._tQ.currency:case s._tQ.decimal:case s._tQ.dollar:case s._tQ.dollarColored:case s._tQ.dollarColoredBold:case s._tQ.percent:case s._tQ.percentComplete:case s._tQ.percentCompleteBar:case s._tQ.percentCompleteBarWithText:case s._tQ.percentSymbol:n=N(r,i,"cell");break;default:l=t.numberFormat}return l||!r.formatter&&!r.groupTotalsFormatter||(n=N(r,i,o,a),t.hasOwnProperty(n)||(t[n]=e.createFormat({format:n})),l=t[n]),{excelFormat:l,groupType:a}}function I(e){const[t,r,s,i,o,l,n,a]=e?.match(/^([^\d(-]*)([(]?)([^\d]*)([-]?[\w]]?[\d\s]*[.,\d]*[\d]*[^)\s%]?)([^\d.,)]*)([)]?)([^\d]*)$/i)||[],h=(o||"").replace(/1/g,"0").replace(/[2]/g,"#");return[$(r??""),s??"",$(i??""),h,$(l??""),n??"",$(a??"")].join("").replace(",",",")}function N(e,t,r,o=""){let l="",n="",a="";const{minDecimal:h,maxDecimal:d,thousandSeparator:c}=function(e,t,r){let i;if("group"===r)switch(e.groupTotalsFormatter){case s.tao.avgTotalsCurrency:case s.tao.avgTotalsDollar:case s.tao.sumTotalsCurrency:case s.tao.sumTotalsCurrencyColored:case s.tao.sumTotalsDollar:case s.tao.sumTotalsDollarBold:case s.tao.sumTotalsDollarColored:case s.tao.sumTotalsDollarColoredBold:i="currency";break;case s.tao.avgTotalsPercentage:i="percent";break;case s.tao.avgTotals:case s.tao.minTotals:case s.tao.maxTotals:case s.tao.sumTotals:case s.tao.sumTotalsColored:case s.tao.sumTotalsBold:default:i="decimal"}else if(e.formatter===s._tQ.multiple&&Array.isArray(e.params?.formatters)){i="decimal";for(const t of e.params.formatters)if(i=P(t),"decimal"!==i)break}else i=P(e.formatter);return(0,s.TT_)(e,t,i,r)}(e,t,r),p=parseFloat(`${c?"2220":"0"}.${function(e,t){return R("1",e)+R("2",t-e)}(h,d)}`);return"group"===r&&e.groupTotalsFormatter?(n=(0,i.stripTags)(e.groupTotalsFormatter({[o]:{[e.field]:p}},e,t)),a=(0,i.stripTags)(e.groupTotalsFormatter({[o]:{[e.field]:-p}},e,t))):e.formatter&&(n=(0,i.stripTags)(e.formatter(0,0,p,e,{},t)),a=(0,i.stripTags)(e.formatter(0,0,-p,e,{},t))),n&&a&&(l=I(n)+";"+I(a)),l}function $(e){return e?`"${e}"`:e}function R(e,t){let r="";for(let s=0;s<t;s++)r+=e;return r}const L={filename:"export",format:s.ptE.xlsx,htmlDecode:!0,useStreamingExport:!0};class M{constructor(){this._fileFormat=s.ptE.xlsx,this._columnHeaders=[],this._hasColumnTitlePreHeader=!1,this._hasGroupedItems=!1,this._pubSubService=null,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},this.className="ExcelExportService"}get _datasetIdPropName(){return this._gridOptions?.datasetIdPropertyName??"id"}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()||{}}get stylesheet(){return this._stylesheet}get stylesheetFormats(){return this._stylesheetFormats}get groupTotalExcelFormats(){return this._groupTotalExcelFormats}get regularCellExcelFormats(){return this._regularCellExcelFormats}dispose(){this._pubSubService?.unsubscribeAll()}init(e,t){if(this._grid=e,this._pubSubService=t.get("PubSubService"),this._locales=this._gridOptions?.locales??s.YMJ.locales,this._translaterService=this._gridOptions?.translater,this._gridOptions.enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be passed in the "translater" Grid Options when "enableTranslate" is enabled. (example: this.gridOptions = { enableTranslate: true, translater: this.translaterService })')}async exportToExcel(e){if(!this._grid||!this._dataView||!this._pubSubService)throw new Error('[Slickgrid-Universal] it seems that the SlickGrid & DataView objects and/or PubSubService are not initialized did you forget to enable the grid option flag "enableExcelExport"?');this._pubSubService?.publish("onBeforeExportToExcel",!0),this._excelExportOptions=(0,i.extend)(!0,{},{...L,...this._gridOptions.excelExportOptions,...e}),this._fileFormat=this._excelExportOptions.format||s.ptE.xlsx;const t=!!this._excelExportOptions.useStreamingExport;this._regularCellExcelFormats={},this._groupTotalExcelFormats={};const r={name:this._excelExportOptions.sheetName||"Sheet1"};this._workbook=new E,this._sheet=this._workbook.createWorksheet(r),this._stylesheet=this._workbook.getStyleSheet();const l=this._stylesheet.createFormat({font:{bold:!0}}),n=this._stylesheet.createFormat({format:"@"}),a=this._stylesheet.createFormat({format:"0"});this._stylesheetFormats={boldFormat:l,numberFormat:a,stringFormat:n},this._sheet.setColumnFormats([l]);try{const e=await this.getDataOutputAsync();this._gridOptions?.excelExportOptions?.customExcelHeader&&this._gridOptions.excelExportOptions.customExcelHeader(this._workbook,this._sheet);const r=this._grid?.getColumns()||[];this._sheet.setColumns(this.getColumnStyles(r));const l=this._sheet.data;let n=l;Array.isArray(l)&&Array.isArray(e)&&(n=this._sheet.data.concat(e)),this._sheet.setData(n),this._workbook.addWorksheet(this._sheet);let a=this._excelExportOptions?.mimeType;void 0===a&&(a=this._fileFormat===s.ptE.xls?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const h=`${this._excelExportOptions.filename}.${this._fileFormat}`;if(this._fileFormat!==s.ptE.xlsx||!t)return await this.legacyExcelExportAsync(h,a);try{const e=function(e,t){if(typeof window<"u"&&void 0!==window.ReadableStream)return function(e,t){return new ReadableStream({async start(r){let s=await e.generateFiles(),i={};for(let[e,t]of Object.entries(s)){let r=e.startsWith("/")?e.substr(1):e;-1!==e.indexOf(".xml")||-1!==e.indexOf(".rel")?i[r]=(0,o._u)(String(t)):i[r]=S(String(t))}let l=(0,o.L)(i,t?.zipOptions||{}),n=0;for(;n<l.length;){let e=l.subarray(n,n+65536);r.enqueue(e),n+=65536,await new Promise((e=>setTimeout(e,0)))}r.close()}})}(e,t);if(typeof process<"u"&&process.versions?.node)return async function*(e,t){let r=await e.generateFiles(),s={};for(let[e,t]of Object.entries(r)){let r=e.startsWith("/")?e.substr(1):e;-1!==e.indexOf(".xml")||-1!==e.indexOf(".rel")?s[r]=(0,o._u)(String(t)):s[r]=S(String(t))}let i=(0,o.L)(s,t?.zipOptions||{}),l=0;for(;l<i.length;)yield i.subarray(l,l+65536),l+=65536,await new Promise((e=>setTimeout(e,0)))}(e,t);throw Error("Streaming is only supported in browser or NodeJS environments.")}(this._workbook,{chunkSize:1e3}),t=[];for await(const r of e)t.push(r);const r=new Blob(t,{type:a}),s=URL.createObjectURL(r),l=(0,i.createDomElement)("a",{href:s,download:h},document.body);return l.click(),document.body.removeChild(l),URL.revokeObjectURL(s),this._pubSubService?.publish("onAfterExportToExcel",{filename:h,mimeType:a}),!0}catch(e){return await this.legacyExcelExportAsync(h,a)}}catch(e){return console.error("Excel export failed:",e),this._pubSubService?.publish("onAfterExportToExcel",{error:e}),!1}}getExcelColumnNameByIndex(e){const t="ZABCDEFGHIJKLMNOPQRSTUVWXY";let r=Math.floor(e/26);const s=Math.floor(e%26);return 0===s&&r--,e>26?this.getExcelColumnNameByIndex(r)+t[s]:t[s]+""}async getDataOutputAsync(){const e=this._grid?.getColumns()||[],t=[],r=this._gridOptions?.excelExportOptions,s=r?.columnHeaderStyle;let i=this._stylesheetFormats.boldFormat.id;if(s&&(i=this._stylesheet.createFormat(s).id),this._gridOptions.createPreHeaderPanel&&this._gridOptions.showPreHeaderPanel&&(!this._gridOptions.enableDraggableGrouping||this._gridOptions.enableDraggableGrouping&&this._gridOptions.createTopHeaderPanel)){const r=this._stylesheet.createFormat({alignment:{horizontal:"center"},font:{bold:!0}});t.push(this.getColumnGroupedHeaderTitlesData(e,{style:r?.id})),this._hasColumnTitlePreHeader=!0}return t.push(this.getColumnHeaderData(e,{style:i})),await this.pushAllGridRowDataToArrayAsync(t,e),t}getColumnStyles(e){const t=this._dataView.getGrouping(),r=[];return Array.isArray(t)&&t.length>0&&r.push({bestFit:!0,columnStyles:this._gridOptions?.excelExportOptions?.customColumnWidth??10}),e.forEach((e=>{const t=e.excludeFromExport??!1;(void 0===e.width||e.width>0)&&!t&&r.push({bestFit:!0,width:e.excelExportOptions?.width??this._gridOptions?.excelExportOptions?.customColumnWidth??10})})),r}getColumnGroupedHeaderTitlesData(e,t){let r=0,s=0,i=[];this.getGroupColumnTitle()&&(i.push({value:""}),s=1),this._groupedColumnHeaders=this.getColumnGroupedHeaderTitles(e)||[],Array.isArray(this._groupedColumnHeaders)&&this._groupedColumnHeaders.length>0&&i.push(...this._groupedColumnHeaders.map((e=>({value:e.title,metadata:t}))));const o=this._groupedColumnHeaders.length;for(let e=0;e<o;e++)if(e+1===o||e+1<o&&this._groupedColumnHeaders[e].title!==this._groupedColumnHeaders[e+1].title){const t=this.getExcelColumnNameByIndex(r+1+s),i=this.getExcelColumnNameByIndex(e+1+s);this._sheet.mergeCells(`${t}1`,`${i}1`),r=e+1}return i}getColumnHeaderData(e,t){let r=[];this._columnHeaders=this.getColumnHeaders(e)||[],this._columnHeaders&&Array.isArray(this._columnHeaders)&&this._columnHeaders.length>0&&(r=this._columnHeaders.map((e=>({value:(0,i.htmlDecode)((0,i.stripTags)(e.title)),metadata:t}))));const s=this.getGroupColumnTitle();return s&&r.unshift({value:s,metadata:t}),r}getGroupColumnTitle(){let e=this._excelExportOptions?.groupingColumnHeaderTitle??"";!e&&this._gridOptions.enableTranslate&&this._translaterService?.translate?e=this._translaterService.translate(`${(0,s.mVi)(this._gridOptions)}GROUP_BY`):e||(e=this._locales?.TEXT_GROUP_BY);const t=this._dataView.getGrouping();return Array.isArray(t)&&t.length>0?(this._hasGroupedItems=!0,e):(this._hasGroupedItems=!1,null)}getColumnGroupedHeaderTitles(e){const t=[];return Array.isArray(e)&&e.forEach((e=>{const r=e.columnGroupKey&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(e.columnGroupKey):e.columnGroup||"",s=e.excludeFromExport||!1;(void 0===e.width||e.width>0)&&!s&&t.push({key:e.field||e.id,title:r||""})})),t}getColumnHeaders(e){const t=[];return Array.isArray(e)&&e.forEach((e=>{let r="";r=e.nameKey&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(e.nameKey):(0,i.getHtmlStringOutput)(e.name||"","innerHTML")||(0,i.titleCase)(e.field);const s=e.excludeFromExport||!1;(void 0===e.width||e.width>0)&&!s&&t.push({key:(e.field||e.id)+"",title:r})})),t}async pushAllGridRowDataToArrayAsync(e,t){const r=this._dataView,s=r.getLength(),i=s<1e3?0:s<1e4?1e3:500,o=r.getGrouping();this._hasGroupedItems=Array.isArray(o)&&o.length>0;for(let o=0;o<s;o++){const s=r.getItem(o);s&&!s.hasOwnProperty("getItem")&&(null!==s[this._datasetIdPropName]&&void 0!==s[this._datasetIdPropName]?e.push(this.readRegularRowData(t,o,s,o)):this._hasGroupedItems&&void 0===s.__groupTotals?e.push([this.readGroupedRowTitle(s)]):s.__groupTotals&&e.push(this.readGroupedTotalRows(t,s,o))),i>0&&o>0&&o%i===0&&await new Promise((e=>setTimeout(e,0)))}return e}preCalculateColumnMetadata(e){const t=new Map,r=this._gridOptions.enableCellRowSpan||e.some((e=>e.colspan||e.rowspan));for(const i of e)if(!i.excludeFromExport){const e=(0,s.lB_)(i),o={...this._excelExportOptions};!1!==i.exportWithFormatter&&(0,s.vsW)(e)&&(o.exportWithFormatter=!0),t.set(String(i.id),{fieldType:e,exportOptions:o,hasFormatter:!!i.formatter,sanitizeData:i.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport,field:i.field,hasComplexSpanning:r})}return t}async efficientYield(){return"function"==typeof globalThis.scheduler?.postTask?new Promise((e=>{globalThis.scheduler.postTask(e,{priority:"user-blocking"})})):new Promise((e=>setTimeout(e,0)))}readRegularRowData(e,t,r,o){let l=0;const n=[],a=e.length;let h=1,d=0;const c=this._dataView.getItemMetadata(t);for(let p=0;p<a;p++){const a=e[p];if(a.excludeFromExport)continue;this._hasGroupedItems&&0===l&&n.push("");let u=1;if(this._gridOptions.enableCellRowSpan){const e=this._grid.getParentRowSpanByCell(t,p,!1);if(e){if(e.start!==t){n.push("");continue}u=e.end-e.start+1}}let m,f=1;if(c?.columns){const t=c.columns,r=t[a.id]||t[p];!isNaN(h)&&+h>1||"*"===h&&p>0||(h=r?.colspan??1),"*"===h?f=e.length-p:(f=h,(a.id in t||p in t)&&(m=a.id,d=p))}if(u>1&&!isNaN(h)&&1===+h&&a.id===m){const e=t+(this._hasColumnTitlePreHeader?3:2),r=this.getExcelColumnNameByIndex(p+1),s=this.getExcelColumnNameByIndex(p+1);this._sheet.mergeCells(`${r}${e}`,`${s}${e+u-1}`)}if("*"===h&&p>0||!isNaN(h)&&+h>1&&a.id!==m){const e=t+(this._hasColumnTitlePreHeader?3:2);if("number"==typeof h&&f-1==1){const t=this.getExcelColumnNameByIndex(d+1),r=this.getExcelColumnNameByIndex(p+1);this._sheet.mergeCells(`${t}${e}`,`${r}${e+u-1}`),n.push("")}else if("*"===h&&1===f){const t=this.getExcelColumnNameByIndex(p+1);this._sheet.mergeCells(`A${e}`,`${t}${e+u-1}`)}else n.push("");"number"==typeof h&&!isNaN(h)&&+h>1&&(f=h--)}else{let e="";const h=(0,s.lB_)(a),d={...this._excelExportOptions};if(!1!==a.exportWithFormatter&&(0,s.vsW)(h)&&(d.exportWithFormatter=!0),e=(0,s.qgn)(t,p,a,r,this._grid,d),!this._regularCellExcelFormats.hasOwnProperty(a.id)){const e=a.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat,t=k(this._stylesheet,this._stylesheetFormats,a,this._grid,e);a.excelExportOptions?.style&&(t.excelFormatId=this._stylesheet.createFormat(a.excelExportOptions.style).id),a.excelExportOptions?.valueParserCallback&&(t.getDataValueParser=a.excelExportOptions.valueParserCallback),this._regularCellExcelFormats[a.id]=t}"string"==typeof e&&((a.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(e=(0,i.stripTags)(e)),this._excelExportOptions.htmlDecode&&(e=(0,i.htmlDecode)(e)));const{excelFormatId:c,getDataValueParser:u}=this._regularCellExcelFormats[a.id];e=u(e,{columnDef:a,excelFormatId:c,stylesheet:this._stylesheet,gridOptions:this._gridOptions,dataRowIdx:o,dataContext:r}),n.push(e),l++}}return n}readGroupedRowTitle(e){const t=(0,i.htmlDecode)((0,i.stripTags)(e.title));if(this._excelExportOptions?.addGroupIndentation){const r=this._excelExportOptions?.groupCollapsedSymbol||"",s=this._excelExportOptions?.groupExpandedSymbol||"";return(e.collapsed?r:s)+" "+(0,i.addWhiteSpaces)(5*e.level)+t}return t}readGroupedTotalRows(e,t,r){const o=[this._excelExportOptions.groupingAggregatorRowText||""];return e.forEach((e=>{let l="";const n=(0,s.lB_)(e),a=e.excludeFromExport||!1;if(e.exportCustomGroupTotalsFormatter){const r=e.exportCustomGroupTotalsFormatter(t,e,this._grid);l=r instanceof HTMLElement?r.textContent||"":r}const h=e.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat;if("number"===n&&!1!==h){let s=this._groupTotalExcelFormats[e.id];s?.groupType||(s=D(this._stylesheet,this._stylesheetFormats,e,this._grid,"group"),e.groupTotalsExcelExportOptions?.style&&(s.excelFormat=this._stylesheet.createFormat(e.groupTotalsExcelExportOptions.style)),this._groupTotalExcelFormats[e.id]=s);const i=e.groupTotalsExcelExportOptions?.valueParserCallback??O;if(void 0!==t[s.groupType]?.[e.field]){const o=i(t,{columnDef:e,groupType:s.groupType,excelFormatId:s.excelFormat?.id,stylesheet:this._stylesheet,dataRowIdx:r});l="object"==typeof o&&o.hasOwnProperty("metadata")?o:l={value:o,metadata:{style:s.excelFormat?.id}}}}else if(e.groupTotalsFormatter){const r=e.groupTotalsFormatter(t,e,this._grid);l=r instanceof HTMLElement?r.textContent||"":r}"string"==typeof l&&((e.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(l=(0,i.stripTags)(l)),this._excelExportOptions.htmlDecode&&(l=(0,i.htmlDecode)(l))),(void 0===e.width||e.width>0)&&!a&&o.push(l)})),o}async legacyExcelExportAsync(e,t){try{return await function(e,t,r){if("node"===r?.downloadType)throw Error('[Excel-Builder-Vanilla] Please note that `downloadExcelFile()` is currently only supporting the "browser" download type at the moment.');let s=t.match(/.*\.xls$/)?"xls":"xlsx";return function(e,t,r){let s={};return new Promise(((t,i)=>{e.generateFiles().then((e=>{for(let[t,r]of Object.entries(e)){let e=t.substr(1);-1!==t.indexOf(".xml")||-1!==t.indexOf(".rel")?s[e]=(0,o._u)(r):s[e]=S(r)}return(0,o.yU)(s,r?.zipOptions||{},((e,s)=>{if(e)i(e);else{let e=r?.fileFormat??"xlsx",i=r?.mimeType;void 0===i&&(i="xls"===e?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t(new Blob([s],{type:i}))}}))}))}))}(e,0,{...r,fileFormat:s}).then((e=>{!function(e,t){let r=document.createElement("a"),s=URL.createObjectURL(t);r&&document&&(r.textContent="download",r.href=s,r.setAttribute("download",e),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s))}(t,e)}))}(this._workbook,e,{mimeType:t}),this._pubSubService?.publish("onAfterExportToExcel",{filename:e,mimeType:t}),!0}catch(e){return console.error("Legacy Excel export failed:",e),this._pubSubService?.publish("onAfterExportToExcel",{error:e}),!1}}}}}]);