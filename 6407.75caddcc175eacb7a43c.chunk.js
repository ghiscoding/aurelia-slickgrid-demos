"use strict";(self.webpackChunkau_slickgrid_demo=self.webpackChunkau_slickgrid_demo||[]).push([[6407],{6407:(e,t,r)=>{r.d(t,{N:()=>Be});var s={},o=Uint8Array,n=Uint16Array,i=Int32Array,a=new o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(e,t){for(var r=new n(31),s=0;s<31;++s)r[s]=t+=1<<e[s-1];var o=new i(r[30]);for(s=1;s<30;++s)for(var a=r[s];a<r[s+1];++a)o[a]=a-r[s]<<5|s;return{b:r,r:o}},d=c(a,2),p=d.b,m=d.r;p[28]=258,m[258]=28;for(var u=c(l,0),f=(u.b,u.r),g=new n(32768),b=0;b<32768;++b){var x=(43690&b)>>1|(21845&b)<<1;x=(61680&(x=(52428&x)>>2|(13107&x)<<2))>>4|(3855&x)<<4,g[b]=((65280&x)>>8|(255&x)<<8)>>1}var y=function(e,t,r){for(var s=e.length,o=0,i=new n(t);o<s;++o)e[o]&&++i[e[o]-1];var a,l=new n(t);for(o=1;o<t;++o)l[o]=l[o-1]+i[o-1]<<1;if(r){a=new n(1<<t);var h=15-t;for(o=0;o<s;++o)if(e[o])for(var c=o<<4|e[o],d=t-e[o],p=l[e[o]-1]++<<d,m=p|(1<<d)-1;p<=m;++p)a[g[p]>>h]=c}else for(a=new n(s),o=0;o<s;++o)e[o]&&(a[o]=g[l[e[o]-1]++]>>15-e[o]);return a},C=new o(288);for(b=0;b<144;++b)C[b]=8;for(b=144;b<256;++b)C[b]=9;for(b=256;b<280;++b)C[b]=7;for(b=280;b<288;++b)C[b]=8;var w=new o(32);for(b=0;b<32;++b)w[b]=5;var _=y(C,9,0),v=y(w,5,0),E=function(e){return(e+7)/8|0},S=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new o(e.subarray(t,r))},F=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],T=function(e,t,r){var s=new Error(t||F[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,T),!r)throw s;return s},A=function(e,t,r){r<<=7&t;var s=t/8|0;e[s]|=r,e[s+1]|=r>>8},k=function(e,t,r){r<<=7&t;var s=t/8|0;e[s]|=r,e[s+1]|=r>>8,e[s+2]|=r>>16},O=function(e,t){for(var r=[],s=0;s<e.length;++s)e[s]&&r.push({s,f:e[s]});var i=r.length,a=r.slice();if(!i)return{t:L,l:0};if(1==i){var l=new o(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var h=r[0],c=r[1],d=0,p=1,m=2;for(r[0]={s:-1,f:h.f+c.f,l:h,r:c};p!=i-1;)h=r[r[d].f<r[m].f?d++:m++],c=r[d!=p&&r[d].f<r[m].f?d++:m++],r[p++]={s:-1,f:h.f+c.f,l:h,r:c};var u=a[0].s;for(s=1;s<i;++s)a[s].s>u&&(u=a[s].s);var f=new n(u+1),g=P(r[p-1],f,0);if(g>t){s=0;var b=0,x=g-t,y=1<<x;for(a.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));s<i;++s){var C=a[s].s;if(!(f[C]>t))break;b+=y-(1<<g-f[C]),f[C]=t}for(b>>=x;b>0;){var w=a[s].s;f[w]<t?b-=1<<t-f[w]++-1:++s}for(;s>=0&&b;--s){var _=a[s].s;f[_]==t&&(--f[_],++b)}g=t}return{t:new o(f),l:g}},P=function(e,t,r){return-1==e.s?Math.max(P(e.l,t,r+1),P(e.r,t,r+1)):t[e.s]=r},D=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new n(++t),s=0,o=e[0],i=1,a=function(e){r[s++]=e},l=1;l<=t;++l)if(e[l]==o&&l!=t)++i;else{if(!o&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(o),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(o);i=1,o=e[l]}return{c:r.subarray(0,s),n:t}},I=function(e,t){for(var r=0,s=0;s<t.length;++s)r+=e[s]*t[s];return r},N=function(e,t,r){var s=r.length,o=E(t+2);e[o]=255&s,e[o+1]=s>>8,e[o+2]=255^e[o],e[o+3]=255^e[o+1];for(var n=0;n<s;++n)e[o+n+4]=r[n];return 8*(o+4+s)},R=function(e,t,r,s,o,i,c,d,p,m,u){A(t,u++,r),++o[256];for(var f=O(o,15),g=f.t,b=f.l,x=O(i,15),E=x.t,S=x.l,F=D(g),T=F.c,P=F.n,R=D(E),$=R.c,L=R.n,M=new n(19),z=0;z<T.length;++z)++M[31&T[z]];for(z=0;z<$.length;++z)++M[31&$[z]];for(var B=O(M,7),H=B.t,V=B.l,j=19;j>4&&!H[h[j-1]];--j);var X,G,W,U,Q=m+5<<3,q=I(o,C)+I(i,w)+c,J=I(o,g)+I(i,E)+c+14+3*j+I(M,H)+2*M[16]+3*M[17]+7*M[18];if(p>=0&&Q<=q&&Q<=J)return N(t,u,e.subarray(p,p+m));if(A(t,u,1+(J<q)),u+=2,J<q){X=y(g,b,0),G=g,W=y(E,S,0),U=E;var K=y(H,V,0);for(A(t,u,P-257),A(t,u+5,L-1),A(t,u+10,j-4),u+=14,z=0;z<j;++z)A(t,u+3*z,H[h[z]]);u+=3*j;for(var Y=[T,$],Z=0;Z<2;++Z){var ee=Y[Z];for(z=0;z<ee.length;++z){var te=31&ee[z];A(t,u,K[te]),u+=H[te],te>15&&(A(t,u,ee[z]>>5&127),u+=ee[z]>>12)}}}else X=_,G=C,W=v,U=w;for(z=0;z<d;++z){var re=s[z];if(re>255){k(t,u,X[257+(te=re>>18&31)]),u+=G[te+257],te>7&&(A(t,u,re>>23&31),u+=a[te]);var se=31&re;k(t,u,W[se]),u+=U[se],se>3&&(k(t,u,re>>5&8191),u+=l[se])}else k(t,u,X[re]),u+=G[re]}return k(t,u,X[256]),u+G[256]},$=new i([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new o(0),M=function(e,t,r,s,h,c){var d=c.z||e.length,p=new o(s+d+5*(1+Math.ceil(d/7e3))+h),u=p.subarray(s,p.length-h),g=c.l,b=7&(c.r||0);if(t){b&&(u[0]=c.r>>3);for(var x=$[t-1],y=x>>13,C=8191&x,w=(1<<r)-1,_=c.p||new n(32768),v=c.h||new n(w+1),F=Math.ceil(r/3),T=2*F,A=function(t){return(e[t]^e[t+1]<<F^e[t+2]<<T)&w},k=new i(25e3),O=new n(288),P=new n(32),D=0,I=0,L=c.i||0,M=0,z=c.w||0,B=0;L+2<d;++L){var H=A(L),V=32767&L,j=v[H];if(_[V]=j,v[H]=V,z<=L){var X=d-L;if((D>7e3||M>24576)&&(X>423||!g)){b=R(e,u,0,k,O,P,I,M,B,L-B,b),M=D=I=0,B=L;for(var G=0;G<286;++G)O[G]=0;for(G=0;G<30;++G)P[G]=0}var W=2,U=0,Q=C,q=V-j&32767;if(X>2&&H==A(L-q))for(var J=Math.min(y,X)-1,K=Math.min(32767,L),Y=Math.min(258,X);q<=K&&--Q&&V!=j;){if(e[L+W]==e[L+W-q]){for(var Z=0;Z<Y&&e[L+Z]==e[L+Z-q];++Z);if(Z>W){if(W=Z,U=q,Z>J)break;var ee=Math.min(q,Z-2),te=0;for(G=0;G<ee;++G){var re=L-q+G&32767,se=re-_[re]&32767;se>te&&(te=se,j=re)}}}q+=(V=j)-(j=_[V])&32767}if(U){k[M++]=268435456|m[W]<<18|f[U];var oe=31&m[W],ne=31&f[U];I+=a[oe]+l[ne],++O[257+oe],++P[ne],z=L+W,++D}else k[M++]=e[L],++O[e[L]]}}for(L=Math.max(L,z);L<d;++L)k[M++]=e[L],++O[e[L]];b=R(e,u,g,k,O,P,I,M,B,L-B,b),g||(c.r=7&b|u[b/8|0]<<3,b-=7,c.h=v,c.p=_,c.i=L,c.w=z)}else{for(L=c.w||0;L<d+g;L+=65535){var ie=L+65535;ie>=d&&(u[b/8|0]=g,ie=d),b=N(u,b+1,e.subarray(L,ie))}c.i=d}return S(p,0,s+E(b)+h)},z=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,s=9;--s;)r=(1&r&&-306674912)^r>>>1;e[t]=r}return e}(),B=function(){var e=-1;return{p:function(t){for(var r=e,s=0;s<t.length;++s)r=z[255&r^t[s]]^r>>>8;e=r},d:function(){return~e}}},H=function(e,t,r,s,n){if(!n&&(n={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),a=new o(i.length+e.length);a.set(i),a.set(e,i.length),e=a,n.w=i.length}return M(e,null==t.level?6:t.level,null==t.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,s,n)},V=function(e,t){var r={};for(var s in e)r[s]=e[s];for(var s in t)r[s]=t[s];return r},j=function(e,t,r){for(var s=e(),o=e.toString(),n=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/\s+/g,"").split(","),i=0;i<s.length;++i){var a=s[i],l=n[i];if("function"==typeof a){t+=";"+l+"=";var h=a.toString();if(a.prototype)if(-1!=h.indexOf("[native code]")){var c=h.indexOf(" ",8)+1;t+=h.slice(c,h.indexOf("(",c))}else for(var d in t+=h,a.prototype)t+=";"+l+".prototype."+d+"="+a.prototype[d].toString();else t+=h}else r[l]=a}return t},X=[],G=function(){return[o,n,i,a,l,h,m,f,_,C,v,w,g,$,L,y,A,k,O,P,D,I,N,R,E,S,M,H,q,W]},W=function(e){return postMessage(e,[e.buffer])},U=function(e,t,r,o,n,i){var a=function(e,t,r,o){if(!X[r]){for(var n="",i={},a=e.length-1,l=0;l<a;++l)n=j(e[l],n,i);X[r]={c:j(e[a],n,i),e:i}}var h=V({},X[r].e);return function(e,t,r,o,n){var i=new Worker(s[t]||(s[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return i.onmessage=function(e){var t=e.data,r=t.$e$;if(r){var s=new Error(r[0]);s.code=r[1],s.stack=r[2],n(s,null)}else n(null,t)},i.postMessage(r,o),i}(X[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,h,function(e){var t=[];for(var r in e)e[r].buffer&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(h),o)}(r,o,n,(function(e,t){a.terminate(),i(e,t)}));return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}},Q=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8};function q(e,t){return H(e,t||{},0,0)}var J=function(e,t,r,s){for(var n in e){var i=e[n],a=t+n,l=s;Array.isArray(i)&&(l=V(s,i[1]),i=i[0]),i instanceof o?r[a]=[i,l]:(r[a+="/"]=[new o(0),l],J(i,a,r,s))}},K="undefined"!=typeof TextEncoder&&new TextEncoder,Y="undefined"!=typeof TextDecoder&&new TextDecoder;try{Y.decode(L,{stream:!0})}catch(e){}function Z(e,t){if(t){for(var r=new o(e.length),s=0;s<e.length;++s)r[s]=e.charCodeAt(s);return r}if(K)return K.encode(e);var n=e.length,i=new o(e.length+(e.length>>1)),a=0,l=function(e){i[a++]=e};for(s=0;s<n;++s){if(a+5>i.length){var h=new o(a+8+(n-s<<1));h.set(i),i=h}var c=e.charCodeAt(s);c<128||t?l(c):c<2048?(l(192|c>>6),l(128|63&c)):c>55295&&c<57344?(l(240|(c=65536+(1047552&c)|1023&e.charCodeAt(++s))>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|63&c)):(l(224|c>>12),l(128|c>>6&63),l(128|63&c))}return S(i,0,a)}var ee=function(e){var t=0;if(e)for(var r in e){var s=e[r].length;s>65535&&T(9),t+=s+4}return t},te=function(e,t,r,s,o,n,i,a){var l=s.length,h=r.extra,c=a&&a.length,d=ee(h);Q(e,t,null!=i?33639248:67324752),t+=4,null!=i&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(n<0&&8),e[t++]=o&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),m=p.getFullYear()-1980;if((m<0||m>119)&&T(10),Q(e,t,m<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>1),t+=4,-1!=n&&(Q(e,t,r.crc),Q(e,t+4,n<0?-n-2:n),Q(e,t+8,r.size)),Q(e,t+12,l),Q(e,t+14,d),t+=16,null!=i&&(Q(e,t,c),Q(e,t+6,r.attrs),Q(e,t+10,i),t+=14),e.set(s,t),t+=l,d)for(var u in h){var f=h[u],g=f.length;Q(e,t,+u),Q(e,t+2,g),e.set(f,t+4),t+=4+g}return c&&(e.set(a,t),t+=c),t},re=function(e,t,r,s,o){Q(e,t,101010256),Q(e,t+8,r),Q(e,t+10,r),Q(e,t+12,s),Q(e,t+16,o)};function se(e,t){t||(t={});var r={},s=[];J(e,"",r,t);var n=0,i=0;for(var a in r){var l=r[a],h=l[0],c=l[1],d=0==c.level?0:8,p=(E=Z(a)).length,m=c.comment,u=m&&Z(m),f=u&&u.length,g=ee(c.extra);p>65535&&T(11);var b=d?q(h,c):h,x=b.length,y=B();y.p(h),s.push(V(c,{size:h.length,crc:y.d(),c:b,f:E,m:u,u:p!=a.length||u&&m.length!=f,o:n,compression:d})),n+=30+p+g+x,i+=76+2*(p+g)+(f||0)+x}for(var C=new o(i+22),w=n,_=i-n,v=0;v<s.length;++v){var E=s[v];te(C,E.o,E,E.f,E.u,E.c.length);var S=30+E.f.length+ee(E.extra);C.set(E.c,E.o+S),te(C,n,E,E.f,E.u,E.c.length,E.o,E.m),n+=16+S+(E.m?E.m.length:0)}return re(C,n,s.length,_,w),C}var oe="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(e){e()};function ne(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)}function ie(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;const r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(e)}function ae(e){return null!=e&&"string"==typeof e.valueOf()}const le={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},he=e=>("string"!=typeof e&&(e=`${e}`),e.replace(/[&<>"']/g,(e=>le[e])));class ce{documentElement;constructor(e,t){this.documentElement=this.createElement(t),this.documentElement.setAttribute("xmlns",e)}createElement(e){return new pe({nodeName:e})}createTextNode(e){return new de(e)}toString(){return this.documentElement.toString()}static Node={Create:e=>{switch(e.type){case"XML":return new pe(e);case"TEXT":return new de(e.nodeValue);default:return null}}}}class de{nodeValue;constructor(e){this.nodeValue=e}toJSON(){return{nodeValue:this.nodeValue,type:"TEXT"}}toString(){return he(this.nodeValue)}}class pe{nodeName="";children;nodeValue;attributes;firstChild;constructor(e){if(this.nodeName=e.nodeName,this.children=[],this.nodeValue=e.nodeValue||"",this.attributes={},e.children)for(let t=0,r=e.children.length;t<r;t++)this.appendChild(ce.Node.Create(e.children[t]));if(e.attributes)for(const t in e.attributes)e.attributes.hasOwnProperty(t)&&this.setAttribute(t,e.attributes[t])}toString(){let e=`<${this.nodeName}`;for(const t in this.attributes)this.attributes.hasOwnProperty(t)&&(e=`${e} ${t}="${he(this.attributes[t])}"`);let t="";for(let e=0,r=this.children.length;e<r;e++)t+=this.children[e].toString();return e+=t?`>${t}</${this.nodeName}>`:"/>",e}toJSON(){const e=[];for(let t=0,r=this.children.length;t<r;t++)e.push(this.children[t].toJSON());return{nodeName:this.nodeName,children:e,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}}setAttribute(e,t){if(null===t)return delete this.attributes[e],void delete this[e];this.attributes[e]=t,this[e]=t}appendChild(e){this.children.push(e),this.firstChild=this.children[0]}cloneNode(e){return new pe(this.toJSON())}}class me{static _idSpaces={};static uniqueId(e){return me._idSpaces[e]||(me._idSpaces[e]=1),me._idSpaces[e]++}static createXmlDoc(e,t){return new ce(e||null,t)}static createElement(e,t,r){const s=e.createElement(t);let o=(r=r||[]).length;for(;o--;)s.setAttribute(r[o][0],r[o][1]);return s}static setAttributesOnDoc(e,t){for(let[r,s]of Object.entries(t))ie(s)&&(null!==s.v&&void 0!==s.v?s.type===Boolean&&(s=s.v?"1":"0"):s=null),null!=s&&e.setAttribute(r,s)}static LETTER_REFS={};static positionToLetterRef(e,t){let r,s=1,o=e,n="";if(me.LETTER_REFS[e])return me.LETTER_REFS[e].concat(t);for(;o>0;)o-=Math.pow(26,s-1),r=o%Math.pow(26,s),o-=r,r/=Math.pow(26,s-1),n="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(r)+n,s+=1;return me.LETTER_REFS[e]=n,n.concat(String(t))}static schemas={worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}}const ue={};function fe(e="$lodash$"){ue[e]||(ue[e]=0);const t=++ue[e];return"$lodash$"===e?`${t}`:`${e}${t}`}const ge={};class be{relations={};lastId=1;constructor(){fe("rId")}importData(e){this.relations=e.relations,this.lastId=e.lastId}exportData(){return{relations:this.relations,lastId:this.lastId}}addRelation(e,t){return this.relations[e.id]={id:fe("rId"),schema:me.schemas[t],object:e},this.relations[e.id].id}getRelationshipId(e){return this.relations[e.id]?this.relations[e.id].id:null}toXML(){const e=me.createXmlDoc(me.schemas.relationshipPackage,"Relationships"),t=e.documentElement;for(const[r,s]of Object.entries(this.relations)){const o=me.createElement(e,"Relationship",[["Id",s.id],["Type",s.schema],["Target",s.object.target||ge[r]]]);s.object.targetMode&&o.setAttribute("TargetMode",s.object.targetMode),t.appendChild(o)}return e}}class xe{state=null;xSplit=null;ySplit=null;activePane="bottomRight";topLeftCell=null;_freezePane;freezePane(e,t,r){this._freezePane={xSplit:e,ySplit:t,cell:r}}exportXML(e){const t=e.createElement("pane");return null!==this.state&&(t.setAttribute("xSplit",this._freezePane.xSplit),t.setAttribute("ySplit",this._freezePane.ySplit),t.setAttribute("topLeftCell",this._freezePane.cell),t.setAttribute("activePane","bottomRight"),t.setAttribute("state","frozen")),t}}class ye{strings={};stringArray=[];id=fe("SharedStrings");addString(e){return this.strings[e]=this.stringArray.length,this.stringArray[this.stringArray.length]=e,this.strings[e]}exportData(){return this.strings}toXML(){const e=me.createXmlDoc(me.schemas.spreadsheetml,"sst"),t=e.documentElement;this.stringArray.reverse();let r=this.stringArray.length;t.setAttribute("count",r),t.setAttribute("uniqueCount",r);const s=e.createElement("si"),o=e.createElement("t");o.appendChild(e.createTextNode("--placeholder--")),s.appendChild(o);const n=this.stringArray;for(;r--;){const e=s.cloneNode(!0);"string"==typeof n[r]&&n[r].match(/\s+/)&&e.firstChild.setAttribute("xml:space","preserve"),e.firstChild.firstChild.nodeValue=n[r],t.appendChild(e)}return e}}class Ce{pane;showZeros=null;defaultGridColor=null;colorId=null;rightToLeft=null;showFormulas=null;showGridLines=null;showOutlineSymbols=null;showRowColHeaders=null;showRuler=null;showWhiteSpace=null;tabSelected=null;topLeftCell=null;viewType=null;windowProtection=null;zoomScale=null;zoomScaleNormal=null;zoomScalePageLayoutView=null;zoomScaleSheetLayoutView=null;constructor(e){const t=e||{};this.pane=t.pane||new xe}freezePane(e,t,r){this.pane.state="frozen",this.pane.xSplit=e,this.pane.ySplit=t,this.pane.topLeftCell=r}exportXML(e){const t=e.createElement("sheetViews"),r=e.createElement("sheetView");return me.setAttributesOnDoc(r,{workbookViewId:0,showZeros:{v:this.showZeros,type:Boolean},defaultGridColor:{v:this.defaultGridColor,type:Boolean},colorId:this.colorId,rightToLeft:{v:this.rightToLeft,type:Boolean},showFormulas:{v:this.showFormulas,type:Boolean},showGridLines:{v:this.showGridLines,type:Boolean},showOutlineSymbols:{v:this.showOutlineSymbols,type:Boolean},showRowColHeaders:{v:this.showRowColHeaders,type:Boolean},showRuler:{v:this.showRuler,type:Boolean},showWhiteSpace:{v:this.showWhiteSpace,type:Boolean},tabSelected:{v:this.tabSelected,type:Boolean},viewType:this.viewType,windowProtection:{v:this.windowProtection,type:Boolean},zoomScale:{v:this.zoomScale,type:Boolean},zoomScaleNormal:this.zoomScaleNormal,zoomScalePageLayoutView:this.zoomScalePageLayoutView,zoomScaleSheetLayoutView:this.zoomScaleSheetLayoutView}),r.appendChild(this.pane.exportXML(e)),t.appendChild(r),t}}class we{id=fe("StyleSheet");cellStyles=[{name:"Normal",xfId:"0",builtinId:"0"}];defaultTableStyle=!1;differentialStyles=[{}];masterCellFormats=[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}];masterCellStyles=[{numFmtId:0,fontId:0,fillId:0,borderId:0}];fonts=[{}];numberFormatters=[];fills=[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}];borders=[{top:{},left:{},right:{},bottom:{},diagonal:{}}];tableStyles=[];createSimpleFormatter(e){const t={id:this.masterCellFormats.length};return"date"===e&&(t.numFmtId=14),this.masterCellFormats.push(t),t}createFill(e){const t=this.fills.length,r=e;return r.id=t,this.fills.push(r),r}createNumberFormatter(e){const t={id:this.numberFormatters.length+100,formatCode:e};return this.numberFormatters.push(t),t}createFormat(e){const t={id:this.masterCellFormats.length};if(e.protection&&(t.protection=e.protection),e.font&&ne(e.font))t.fontId=this.createFontStyle(e.font).id;else if(e.font){if(Number.isNaN(Number.parseInt(e.font,10)))throw new Error("Passing a non-numeric font id is not supported");t.fontId=e.font}if(e.format&&ae(e.format))t.numFmtId=this.createNumberFormatter(e.format).id;else if(e.format){if(Number.isNaN(Number.parseInt(e.format,10)))throw new Error("Invalid number formatter id");t.numFmtId=e.format}if(e.border&&ne(e.border))t.borderId=this.createBorderFormatter(e.border).id;else if(e.border){if(Number.isNaN(Number.parseInt(e.border,10)))throw new Error("Passing a non-numeric border id is not supported");t.borderId=e.border}if(e.fill&&ne(e.fill))t.fillId=this.createFill(e.fill).id;else if(e.fill){if(Number.isNaN(Number.parseInt(e.fill,10)))throw new Error("Passing a non-numeric fill id is not supported");t.fillId=e.fill}return e.alignment&&ne(e.alignment)&&(t.alignment=(r=e.alignment,["horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText"].reduce(((e,t)=>(r?.hasOwnProperty(t)&&(e[t]=r[t]),e)),{}))),this.masterCellFormats.push(t),t;var r}createDifferentialStyle(e){const t=this.differentialStyles.length,r={id:t};return e.font&&ne(e.font)&&(r.font=e.font),e.border&&ne(e.border)&&(r.border=Object.assign({top:{},left:{},right:{},bottom:{},diagonal:{}},e.border)),e.fill&&ne(e.fill)&&(r.fill=e.fill),e.alignment&&ne(e.alignment)&&(r.alignment=e.alignment),e.format&&ae(e.format)&&(r.numFmt=e.format),this.differentialStyles[t]=r,r}createTableStyle(e){this.tableStyles.push(e)}createBorderFormatter(e){return e={top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length,...e},this.borders.push(e),e}createFontStyle(e){const t={id:this.fonts.length};return e.bold&&(t.bold=!0),e.italic&&(t.italic=!0),e.superscript&&(t.vertAlign="superscript"),e.subscript&&(t.vertAlign="subscript"),e.underline&&("string"==typeof e.underline&&["double","singleAccounting","doubleAccounting"].includes(e.underline)?t.underline=e.underline:t.underline=!0),e.strike&&(t.strike=!0),e.outline&&(t.outline=!0),e.shadow&&(t.shadow=!0),e.size&&(t.size=e.size),e.color&&(t.color=e.color),e.fontName&&(t.fontName=e.fontName),this.fonts.push(t),t}exportBorders(e){const t=e.createElement("borders");t.setAttribute("count",this.borders.length);for(let r=0,s=this.borders.length;r<s;r++)t.appendChild(this.exportBorder(e,this.borders[r]));return t}exportBorder(e,t){const r=e.createElement("border"),s=r=>{const s=e.createElement(r);return t[r].style&&s.setAttribute("style",t[r].style),t[r].color&&s.appendChild(this.exportColor(e,t[r].color)),s};return r.appendChild(s("left")),r.appendChild(s("right")),r.appendChild(s("top")),r.appendChild(s("bottom")),r.appendChild(s("diagonal")),r}exportColor(e,t){const r=e.createElement("color");return ae(t)?(r.setAttribute("rgb",t),r):(void 0!==t.tint&&r.setAttribute("tint",t.tint),void 0!==t.auto&&r.setAttribute("auto",String(!!t.auto)),void 0!==t.theme&&r.setAttribute("theme",t.theme),r)}exportMasterCellFormats(e){const t=me.createElement(e,"cellXfs",[["count",this.masterCellFormats.length]]);for(let r=0,s=this.masterCellFormats.length;r<s;r++){const s=this.masterCellFormats[r];t.appendChild(this.exportCellFormatElement(e,s))}return t}exportMasterCellStyles(e){const t=me.createElement(e,"cellStyleXfs",[["count",this.masterCellStyles.length]]);for(let r=0,s=this.masterCellStyles.length;r<s;r++){const s=this.masterCellStyles[r];t.appendChild(this.exportCellFormatElement(e,s))}return t}exportCellFormatElement(e,t){const r=e.createElement("xf"),s=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],o=Object.keys(t).filter((e=>-1!==s.indexOf(e)));if(t.alignment){const s=t.alignment;r.appendChild(this.exportAlignment(e,s))}t.protection&&(r.appendChild(this.exportProtection(e,t.protection)),r.setAttribute("applyProtection","1"));let n=o.length;for(;n--;)r.setAttribute(o[n],t[o[n]]);return t.fillId&&r.setAttribute("applyFill","1"),t.fontId&&r.setAttribute("applyFont","1"),t.borderId&&r.setAttribute("applyBorder","1"),t.alignment&&r.setAttribute("applyAlignment","1"),t.numFmtId&&r.setAttribute("applyNumberFormat","1"),void 0!==t.numFmtId&&void 0===t.xfId&&r.setAttribute("xfId","0"),r}exportAlignment(e,t){const r=e.createElement("alignment"),s=Object.keys(t);for(let e=0,o=s.length;e<o;e++)r.setAttribute(s[e],t[s[e]]);return r}exportFonts(e){const t=e.createElement("fonts");t.setAttribute("count",String(this.fonts.length));for(let r=0,s=this.fonts.length;r<s;r++){const s=this.fonts[r];t.appendChild(this.exportFont(e,s))}return t}exportFont(e,t){const r=e.createElement("font");if(t.size){const s=e.createElement("sz");s.setAttribute("val",t.size),r.appendChild(s)}if(t.fontName){const s=e.createElement("name");s.setAttribute("val",t.fontName),r.appendChild(s)}if(t.bold&&r.appendChild(e.createElement("b")),t.italic&&r.appendChild(e.createElement("i")),t.vertAlign){const s=e.createElement("vertAlign");s.setAttribute("val",t.vertAlign),r.appendChild(s)}if(t.underline){const s=e.createElement("u");!0!==t.underline&&s.setAttribute("val",t.underline),r.appendChild(s)}return t.strike&&r.appendChild(e.createElement("strike")),t.shadow&&r.appendChild(e.createElement("shadow")),t.outline&&r.appendChild(e.createElement("outline")),t.color&&r.appendChild(this.exportColor(e,t.color)),r}exportFills(e){const t=e.createElement("fills");t.setAttribute("count",String(this.fills.length));for(let r=0,s=this.fills.length;r<s;r++){const s=this.fills[r];t.appendChild(this.exportFill(e,s))}return t}exportFill(e,t){let r;const s=e.createElement("fill");return"pattern"===t.type?(r=this.exportPatternFill(e,t),s.appendChild(r)):"gradient"===t.type&&(r=this.exportGradientFill(e,t),s.appendChild(r)),s}exportGradientFill(e,t){const r=e.createElement("gradientFill");t.degree?r.setAttribute("degree",t.degree):t.left&&(r.setAttribute("left",t.left),r.setAttribute("right",t.right),r.setAttribute("top",t.top),r.setAttribute("bottom",t.bottom));const s=e.createElement("stop");s.setAttribute("position",t.start.pureAt||0);const o=e.createElement("color");"string"==typeof t.start||t.start.color?o.setAttribute("rgb",t.start.color||t.start):t.start.theme&&o.setAttribute("theme",t.start.theme);const n=e.createElement("stop"),i=e.createElement("color");return n.setAttribute("position",t.end.pureAt||1),"string"==typeof t.start||t.end.color?i.setAttribute("rgb",t.end.color||t.end):t.end.theme&&i.setAttribute("theme",t.end.theme),s.appendChild(o),n.appendChild(i),r.appendChild(s),r.appendChild(n),r}exportPatternFill(e,t){const r=me.createElement(e,"patternFill",[["patternType",t.patternType]]);t.bgColor||(t.bgColor="FFFFFFFF"),t.fgColor||(t.fgColor="FFFFFFFF");const s=e.createElement("bgColor");ae(t.bgColor)?s.setAttribute("rgb",t.bgColor):t.bgColor.theme?s.setAttribute("theme",t.bgColor.theme):s.setAttribute("rgb",t.bgColor.rbg);const o=e.createElement("fgColor");return ae(t.fgColor)?o.setAttribute("rgb",t.fgColor):t.fgColor.theme?o.setAttribute("theme",t.fgColor.theme):o.setAttribute("rgb",t.fgColor.rbg),r.appendChild(o),r.appendChild(s),r}exportNumberFormatters(e){const t=e.createElement("numFmts");t.setAttribute("count",String(this.numberFormatters.length));for(let r=0,s=this.numberFormatters.length;r<s;r++){const s=this.numberFormatters[r];t.appendChild(this.exportNumberFormatter(e,s))}return t}exportNumberFormatter(e,t){const r=e.createElement("numFmt");return r.setAttribute("numFmtId",t.id),r.setAttribute("formatCode",t.formatCode),r}exportCellStyles(e){const t=e.createElement("cellStyles");t.setAttribute("count",String(this.cellStyles.length));for(let r=0,s=this.cellStyles.length;r<s;r++){const s=this.cellStyles[r];delete s.id;const o=me.createElement(e,"cellStyle");t.appendChild(o);const n=Object.keys(s);let i=n.length;for(;i--;)o.setAttribute(n[i],s[n[i]])}return t}exportDifferentialStyles(e){const t=e.createElement("dxfs");t.setAttribute("count",String(this.differentialStyles.length));for(let r=0,s=this.differentialStyles.length;r<s;r++){const s=this.differentialStyles[r];t.appendChild(this.exportDFX(e,s))}return t}exportDFX(e,t){const r=e.createElement("dxf");return t.font&&r.appendChild(this.exportFont(e,t.font)),t.fill&&r.appendChild(this.exportFill(e,t.fill)),t.border&&r.appendChild(this.exportBorder(e,t.border)),t.numFmt&&r.appendChild(this.exportNumberFormatter(e,t.numFmt)),t.alignment&&r.appendChild(this.exportAlignment(e,t.alignment)),r}exportTableStyles(e){const t=e.createElement("tableStyles");t.setAttribute("count",String(this.tableStyles.length)),this.defaultTableStyle&&t.setAttribute("defaultTableStyle",String(this.defaultTableStyle));for(let r=0,s=this.tableStyles.length;r<s;r++)t.appendChild(this.exportTableStyle(e,this.tableStyles[r]));return t}exportTableStyle(e,t){const r=e.createElement("tableStyle");r.setAttribute("name",t.name),r.setAttribute("pivot",String(0));let s=0;return Object.entries(t).forEach((([t,o])=>{if("name"===t)return;s++;const n=e.createElement("tableStyleElement");n.setAttribute("type",t),n.setAttribute("dxfId",o),r.appendChild(n)})),r.setAttribute("count",String(s)),r}exportProtection(e,t){const r=e.createElement("protection");for(const e in t)e in t&&r.setAttribute(e,t[e]);return r}toXML(){const e=me.createXmlDoc(me.schemas.spreadsheetml,"styleSheet"),t=e.documentElement;return t.appendChild(this.exportNumberFormatters(e)),t.appendChild(this.exportFonts(e)),t.appendChild(this.exportFills(e)),t.appendChild(this.exportBorders(e)),t.appendChild(this.exportMasterCellStyles(e)),t.appendChild(this.exportMasterCellFormats(e)),t.appendChild(this.exportCellStyles(e)),t.appendChild(this.exportDifferentialStyles(e)),this.tableStyles.length&&t.appendChild(this.exportTableStyles(e)),e}}class _e{name="";id=fe("Worksheet");_timezoneOffset;relations=null;columnFormats=[];data=[];mergedCells=[];columns=[];sheetProtection=!1;_headers=[];_footers=[];_tables=[];_drawings=[];_orientation;_margin;_rowInstructions={};_freezePane={};sharedStrings=null;hyperlinks=[];sheetView;showZeros=null;constructor(e){this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.sheetView=e.sheetView||new Ce,this.initialize(e)}initialize(e){e=e||{},this.name=e.name,this.id=fe("Worksheet"),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,e.columns&&this.setColumns(e.columns),this.relations=new be}exportData(){return{relations:this.relations.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,_freezePane:this._freezePane,name:this.name,id:this.id}}importData(e){this.relations.importData(e.relations),delete e.relations,Object.assign(this,e)}setSharedStringCollection(e){this.sharedStrings=e}addTable(e){this._tables.push(e),this.relations.addRelation(e,"table")}addDrawings(e){this._drawings.push(e),this.relations.addRelation(e,"drawingRelationship")}setRowInstructions(e,t){this._rowInstructions[e]=t}setHeader(e){if(!Array.isArray(e))throw"Invalid argument type - setHeader expects an array of three instructions";this._headers=e}setFooter(e){if(!Array.isArray(e))throw"Invalid argument type - setFooter expects an array of three instructions";this._footers=e}compilePageDetailPackage(e){return e=e||"",["&L",this.compilePageDetailPiece(e[0]||""),"&C",this.compilePageDetailPiece(e[1]||""),"&R",this.compilePageDetailPiece(e[2]||"")].join("")}compilePageDetailPiece(e){if(ae(e))return'&"-,Regular"'.concat(e);if(ne(e)&&!Array.isArray(e)){let t="";if(e.font||e.bold){const r=e.bold?"Bold":"Regular";t+=`&"${e.font||"-"}`,t+=`,${r}"`}else t+='&"-,Regular"';return e.underline&&(t+="&U"),e.fontSize&&(t+=`&${e.fontSize}`),t+=e.text,t}return Array.isArray(e)?e.reduce(((e,t)=>e.concat(this.compilePageDetailPiece(t))),""):void 0}exportHeader(e){const t=e.createElement("oddHeader");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._headers))),t}exportFooter(e){const t=e.createElement("oddFooter");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._footers))),t}_buildCache(e){const t=e.createElement("c"),r=e.createElement("v");r.appendChild(e.createTextNode("--temp--")),t.appendChild(r);const s=e.createElement("c"),o=e.createElement("f");o.appendChild(e.createTextNode("--temp--")),s.appendChild(o);const n=e.createElement("c");n.setAttribute("t","s");const i=e.createElement("v");return i.appendChild(e.createTextNode("--temp--")),n.appendChild(i),{number:t,date:t,string:n,formula:s}}collectSharedStrings(){const e=this.data,t={};for(let r=0,s=e.length;r<s;r++){const s=e[r],o=s.length;for(let e=0;e<o;e++){let r=s[e];const o=r?.metadata||{};r&&"object"==typeof r&&(r=r.value),o.type||"number"==typeof r&&(o.type="number"),("text"===o.type||!o.type)&&typeof t[r]>"u"&&(t[r]=!0)}}return Object.keys(t)}toXML(){const e=this.data,t=this.columns||[],r=me.createXmlDoc(me.schemas.spreadsheetml,"worksheet"),s=r.documentElement;let o,n,i;s.setAttribute("xmlns:r",me.schemas.relationships),s.setAttribute("xmlns:mc",me.schemas.markupCompat);let a=0;const l=me.createElement(r,"sheetData"),h=this._buildCache(r);for(i=0,n=e.length;i<n;i++){const s=e[i],o=s.length;a=o>a?o:a;const n=r.createElement("row");for(let e=0;e<o;e++){t[e]=t[e]||{};let r,o=s[e];const a=o?.metadata||{};switch(o&&"object"==typeof o&&(o=o.value),a.type||"number"==typeof o&&(a.type="number"),a.type){case"number":r=h.number.cloneNode(!0),r.firstChild.firstChild.nodeValue=o;break;case"date":r=h.date.cloneNode(!0),o instanceof Date&&(o=o.getTime()),r.firstChild.firstChild.nodeValue=25569+(o-this._timezoneOffset)/864e5;break;case"formula":r=h.formula.cloneNode(!0),r.firstChild.firstChild.nodeValue=o;break;default:{let e;e=typeof this.sharedStrings?.strings[o]<"u"?this.sharedStrings.strings[o]:this.sharedStrings?.addString(o),r=h.string.cloneNode(!0),r.firstChild.firstChild.nodeValue=e;break}}a.style?r.setAttribute("s",a.style):void 0!==this._rowInstructions[i]?.style&&r.setAttribute("s",this._rowInstructions[i].style),r.setAttribute("r",me.positionToLetterRef(e+1,String(i+1))),n.appendChild(r)}if(n.setAttribute("r",i+1),this._rowInstructions[i]){const e=this._rowInstructions[i];void 0!==e.height&&(n.setAttribute("customHeight","1"),n.setAttribute("ht",e.height)),void 0!==e.style&&(n.setAttribute("customFormat","1"),n.setAttribute("s",e.style))}l.appendChild(n)}if(0!==a?s.appendChild(me.createElement(r,"dimension",[["ref",`${me.positionToLetterRef(1,1)}:${me.positionToLetterRef(a,String(e.length))}`]])):s.appendChild(me.createElement(r,"dimension",[["ref",me.positionToLetterRef(1,1)]])),s.appendChild(this.sheetView.exportXML(r)),this.columns.length&&s.appendChild(this.exportColumns(r)),s.appendChild(l),this.sheetProtection&&s.appendChild(this.sheetProtection.exportXML(r)),this.hyperlinks.length>0){const e=r.createElement("hyperlinks"),t=this.hyperlinks;for(o=0,n=t.length;o<n;o++){const s=r.createElement("hyperlink"),n=t[o];s.setAttribute("ref",String(n.cell)),n.id=me.uniqueId("hyperlink"),this.relations.addRelation({id:n.id,target:n.location,targetMode:n.targetMode||"External"},"hyperlink"),s.setAttribute("r:id",this.relations.getRelationshipId(n)),e.appendChild(s)}s.appendChild(e)}if(this.mergedCells.length>0){const e=r.createElement("mergeCells");for(o=0,n=this.mergedCells.length;o<n;o++){const t=r.createElement("mergeCell");t.setAttribute("ref",`${this.mergedCells[o][0]}:${this.mergedCells[o][1]}`),e.appendChild(t)}s.appendChild(e)}if(this.exportPageSettings(r,s),this._headers.length>0||this._footers.length>0){const e=r.createElement("headerFooter");this._headers.length>0&&e.appendChild(this.exportHeader(r)),this._footers.length>0&&e.appendChild(this.exportFooter(r)),s.appendChild(e)}for(o=0,n=this._drawings.length;o<n;o++){const e=r.createElement("drawing");e.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[o])),s.appendChild(e)}if(this._tables.length>0){const e=r.createElement("tableParts");for(e.setAttribute("count",this._tables.length),o=0,n=this._tables.length;o<n;o++){const t=r.createElement("tablePart");t.setAttribute("r:id",this.relations.getRelationshipId(this._tables[o])),e.appendChild(t)}s.appendChild(e)}return r}exportColumns(e){const t=me.createElement(e,"cols");for(let r=0,s=this.columns.length;r<s;r++){const s=this.columns[r],o=me.createElement(e,"col",[["min",s.min||r+1],["max",s.max||r+1]]);s.hidden&&o.setAttribute("hidden",String(1)),s.bestFit&&o.setAttribute("bestFit",String(1)),(s.customWidth||s.width)&&o.setAttribute("customWidth",String(1)),s.width?o.setAttribute("width",s.width):o.setAttribute("width",String(9.140625)),t.appendChild(o)}return t}exportPageSettings(e,t){if(this._margin){let r=.7;const s=this._margin.left?this._margin.left:r,o=this._margin.right?this._margin.right:r,n=this._margin.top?this._margin.top:r,i=this._margin.bottom?this._margin.bottom:r;r=.3;const a=this._margin.header?this._margin.header:r,l=this._margin.footer?this._margin.footer:r;t.appendChild(me.createElement(e,"pageMargins",[["top",n],["bottom",i],["left",s],["right",o],["header",a],["footer",l]]))}this._orientation&&t.appendChild(me.createElement(e,"pageSetup",[["orientation",this._orientation]]))}setPageOrientation(e){this._orientation=e}setPageMargin(e){this._margin=e}setColumns(e){this.columns=e}setData(e){this.data=e}mergeCells(e,t){this.mergedCells.push([e,t])}freezePane(e,t,r){this.sheetView.freezePane(e,t,r)}setColumnFormats(e){this.columnFormats=e}getWorksheetXmlHeader(){return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<worksheet xmlns="${me.schemas.spreadsheetml}"\n           xmlns:r="${me.schemas.relationships}"\n           xmlns:mc="${me.schemas.markupCompat}">`}getWorksheetXmlFooter(){if(this._headers.length>0||this._footers.length>0){let e="<headerFooter>";return this._headers.length>0&&(e+=`<oddHeader>${this.compilePageDetailPackage(this._headers)}</oddHeader>`),this._footers.length>0&&(e+=`<oddFooter>${this.compilePageDetailPackage(this._footers)}</oddFooter>`),e+="</headerFooter>",e}return""}serializeRows(e,t=0){let r="";for(let s=0,o=e.length;s<o;s++){const o=e[s],n=o.length;let i=`<row r="${t+s+1}">`;for(let e=0;e<n;e++){const r=o[e],n=typeof r;let a="";const l=` r="${String.fromCharCode(65+e)}${t+s+1}"`;switch(n){case"number":a=`<c${l}><v>${r}</v></c>`;break;default:{let e;e=typeof this.sharedStrings?.strings[r]<"u"?this.sharedStrings.strings[r]:this.sharedStrings?.addString(r),a=`<c${l} t="s"><v>${e}</v></c>`;break}}i+=a}i+="</row>",r+=i}return r}}class ve{id=fe("Workbook");styleSheet=new we;sharedStrings=new ye;relations=new be;worksheets=[];tables=[];drawings=[];media={};printTitles;constructor(){this.initialize()}initialize(){this.id=fe("Workbook"),this.styleSheet=new we,this.sharedStrings=new ye,this.relations=new be,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")}createWorksheet(e){return e=Object.assign({},{name:"Sheet ".concat(String(this.worksheets.length+1))},e),new _e(e)}getStyleSheet(){return this.styleSheet}addTable(e){this.tables.push(e)}addDrawings(e){this.drawings.push(e)}setPrintTitleTop(e,t){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[e]&&(this.printTitles[e]={}),this.printTitles[e].top=t}setPrintTitleLeft(e,t){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[e]&&(this.printTitles[e]={}),this.printTitles[e].left=String.fromCharCode(64+t)}addMedia(e,t,r,s){const o=t.split("."),n=o[o.length-1];if(!s)switch(n.toLowerCase()){case"jpeg":case"jpg":s="image/jpeg";break;case"png":s="image/png";break;case"gif":s="image/gif";break;default:s=null}return this.media[t]||(this.media[t]={id:t,data:r,fileName:t,contentType:s,extension:n}),this.media[t]}addWorksheet(e){this.relations.addRelation(e,"worksheet"),e.setSharedStringCollection(this.sharedStrings),this.worksheets.push(e)}createContentTypes(){const e=me.createXmlDoc(me.schemas.contentTypes,"Types"),t=e.documentElement;let r,s;t.appendChild(me.createElement(e,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),t.appendChild(me.createElement(e,"Default",[["Extension","xml"],["ContentType","application/xml"]]));const o={};for(const e in this.media)e in this.media&&(o[this.media[e].extension]=this.media[e].contentType);for(const r in o)r in o&&t.appendChild(me.createElement(e,"Default",[["Extension",r],["ContentType",o[r]]]));for(t.appendChild(me.createElement(e,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),t.appendChild(me.createElement(e,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),t.appendChild(me.createElement(e,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),r=0,s=this.worksheets.length;r<s;r++)t.appendChild(me.createElement(e,"Override",[["PartName",`/xl/worksheets/sheet${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(r=0,s=this.tables.length;r<s;r++)t.appendChild(me.createElement(e,"Override",[["PartName",`/xl/tables/table${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(r=0,s=this.drawings.length;r<s;r++)t.appendChild(me.createElement(e,"Override",[["PartName",`/xl/drawings/drawing${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));return e}toXML(){const e=me.createXmlDoc(me.schemas.spreadsheetml,"workbook"),t=e.documentElement;t.setAttribute("xmlns:r",me.schemas.relationships);const r=me.createElement(e,"sheets");for(let t=0,s=this.worksheets.length;t<s;t++){const s=e.createElement("sheet");typeof console<"u"&&this.worksheets[t].name.length>31&&console.log(`Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "${this.worksheets[t].name}" is ${this.worksheets[t].name.length} characters long`),s.setAttribute("name",this.worksheets[t].name),s.setAttribute("sheetId",t+1),s.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[t])),r.appendChild(s)}t.appendChild(r);const s=me.createElement(e,"definedNames");let o=0;for(const t in this.printTitles)if(t in this.printTitles){const r=this.printTitles[t],n=e.createElement("definedName");n.setAttribute("name","_xlnm.Print_Titles"),n.setAttribute("localSheetId",o++);let i="";r.top&&(i+=`${t}!$1:$${r.top}`,r.left&&(i+=",")),r.left&&(i+=`${t}!$A:$${r.left}`),n.appendChild(e.createTextNode(i)),s.appendChild(n)}return t.appendChild(s),e}createWorkbookRelationship(){const e=me.createXmlDoc(me.schemas.relationshipPackage,"Relationships");return e.documentElement.appendChild(me.createElement(e,"Relationship",[["Id","rId1"],["Type",me.schemas.officeDocument],["Target","xl/workbook.xml"]])),e}_generateCorePaths(e){let t,r;for(ge[this.styleSheet.id]="styles.xml",ge[this.sharedStrings.id]="sharedStrings.xml",ge[this.id]="/xl/workbook.xml",t=0,r=this.tables.length;t<r;t++)e[`/xl/tables/table${t+1}.xml`]=this.tables[t].toXML(),ge[this.tables[t].id]=`/xl/tables/table${t+1}.xml`;for(const t in this.media)if(t in this.media){const r=this.media[t];e[`/xl/media/${t}`]=r.data,ge[t]=`/xl/media/${t}`}for(t=0,r=this.drawings.length;t<r;t++)e[`/xl/drawings/drawing${t+1}.xml`]=this.drawings[t].toXML(),ge[this.drawings[t].id]=`/xl/drawings/drawing${t+1}.xml`,e[`/xl/drawings/_rels/drawing${t+1}.xml.rels`]=this.drawings[t].relations.toXML()}_prepareFilesForPackaging(e){Object.assign(e,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()});for(const[t,r]of Object.entries(e))if(-1!==t.indexOf(".xml")||-1!==t.indexOf(".rels")){e[t]=r instanceof ce?r.toString():r.xml||(new window.XMLSerializer).serializeToString(r);let s=e[t].replace(/xmlns=""/g,"");s=s.replace(/NS[\d]+:/g,""),s=s.replace(/xmlns:NS[\d]+=""/g,""),e[t]=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n${s}`}}generateFiles(){return new Promise((e=>{const t={};this._generateCorePaths(t);for(let e=0,r=this.worksheets.length;e<r;e++){const r=this.worksheets[e].toXML();t[`/xl/worksheets/sheet${e+1}.xml`]=r,ge[this.worksheets[e].id]=`worksheets/sheet${e+1}.xml`,t[`/xl/worksheets/_rels/sheet${e+1}.xml.rels`]=this.worksheets[e].relations.toXML()}return this._prepareFilesForPackaging(t),e(t)}))}serializeHeader(){return'<?xml version="1.0" encoding="UTF-8"?><workbook>'}serializeFooter(){return"</workbook>"}}function Ee(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4),s=atob(t+r);return Uint8Array.from(s,(e=>e.charCodeAt(0)))}function Se(e,t,r){if("node"===r?.downloadType)throw new Error('[Excel-Builder-Vanilla] Please note that `downloadExcelFile()` is currently only supporting the "browser" download type at the moment.');const s=t.match(/.*\.xls$/)?"xls":"xlsx";return function(e,t,r){const s={};return new Promise(((t,n)=>{e.generateFiles().then((e=>{for(const[t,r]of Object.entries(e)){const e=t.substr(1);-1!==t.indexOf(".xml")||-1!==t.indexOf(".rel")?s[e]=Z(r):s[e]=Ee(r)}return function(e,t,r){r||(r=t,t={}),"function"!=typeof r&&T(7);var s={};J(e,"",s,t);var n=Object.keys(s),i=n.length,a=0,l=0,h=i,c=new Array(i),d=[],p=function(){for(var e=0;e<d.length;++e)d[e]()},m=function(e,t){oe((function(){r(e,t)}))};oe((function(){m=r}));var u=function(){var e=new o(l+22),t=a,r=l-a;l=0;for(var s=0;s<h;++s){var n=c[s];try{var i=n.c.length;te(e,l,n,n.f,n.u,i);var d=30+n.f.length+ee(n.extra),p=l+d;e.set(n.c,p),te(e,a,n,n.f,n.u,i,l,n.m),a+=16+d+(n.m?n.m.length:0),l=p+i}catch(e){return m(e,null)}}re(e,a,c.length,r,t),m(null,e)};i||u();for(var f=function(e){var t=n[e],r=s[t],o=r[0],h=r[1],f=B(),g=o.length;f.p(o);var b=Z(t),x=b.length,y=h.comment,C=y&&Z(y),w=C&&C.length,_=ee(h.extra),v=0==h.level?0:8,E=function(r,s){if(r)p(),m(r,null);else{var o=s.length;c[e]=V(h,{size:g,crc:f.d(),c:s,f:b,m:C,u:x!=t.length||C&&y.length!=w,compression:v}),a+=30+x+_+o,l+=76+2*(x+_)+(w||0)+o,--i||u()}};if(x>65535&&E(T(11,0,1),null),v)if(g<16e4)try{E(null,q(o,h))}catch(e){E(e,null)}else d.push(function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&T(7),U(e,t,[G],(function(e){return W(q(e.data[0],e.data[1]))}),0,r)}(o,h,E));else E(null,o)},g=0;g<h;++g)f(g);return p}(s,r?.zipOptions||{},((e,s)=>{if(e)n(e);else{{const e=r?.fileFormat??"xlsx";let o=r?.mimeType;void 0===o&&(o="xls"===e?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t(new Blob([s],{type:o}))}}}))}))}))}(e,0,{...r,fileFormat:s}).then((e=>{!function(e,t){const r=document.createElement("a"),s=URL.createObjectURL(t);r&&document&&(r.textContent="download",r.href=s,r.setAttribute("download",e),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s))}(t,e)}))}var Fe=r(8639),Te=r(1322);const Ae=(e,{excelFormatId:t})=>void 0!==t?{value:e,metadata:{style:t}}:e,ke=(e,{columnDef:t,excelFormatId:r,gridOptions:s})=>({value:"string"==typeof e&&/\d/g.test(e)?Oe(e,t,s):e,metadata:{style:r}});function Oe(e,t,r){let s=e;if("string"==typeof e&&e){const o=","===(0,Fe.Nv7)("decimalSeparator",t,r,Fe.YMJ.DEFAULT_NUMBER_DECIMAL_SEPARATOR)?parseFloat(e.replace(/[^0-9,-]+/g,"").replace(",",".")):parseFloat(e.replace(/[^\d.-]/g,""));s=isNaN(o)?e:o}return s}function Pe(e,t,r,s,o=!0){const n=(0,Fe.lB_)(r);let i,a=Ae;return n===Fe.PUO.number&&o&&(i=Ne(e,t,r,s,"cell").excelFormat.id,a=ke),{excelFormatId:i,getDataValueParser:a}}function De(e,t){return e?.[t.groupType]?.[t.columnDef.field]??0}function Ie(e){let t;switch(e){case Fe._tQ.currency:case Fe._tQ.dollar:case Fe._tQ.dollarColored:case Fe._tQ.dollarColoredBold:t="currency";break;case Fe._tQ.percent:case Fe._tQ.percentComplete:case Fe._tQ.percentCompleteBar:case Fe._tQ.percentCompleteBarWithText:case Fe._tQ.percentSymbol:t="percent";break;case Fe._tQ.decimal:default:t="decimal"}return t}function Ne(e,t,r,s,o){let n,i="",a=r.groupTotalsExcelExportOptions?.groupType||"";const l=(0,Fe.lB_)(r);if("group"===o)switch(r.groupTotalsFormatter){case Fe.tao.avgTotals:case Fe.tao.avgTotalsCurrency:case Fe.tao.avgTotalsDollar:case Fe.tao.avgTotalsPercentage:a="avg";break;case Fe.tao.minTotals:a="min";break;case Fe.tao.maxTotals:a="max";break;case Fe.tao.sumTotals:case Fe.tao.sumTotalsBold:case Fe.tao.sumTotalsColored:case Fe.tao.sumTotalsCurrency:case Fe.tao.sumTotalsCurrencyColored:case Fe.tao.sumTotalsDollar:case Fe.tao.sumTotalsDollarColoredBold:case Fe.tao.sumTotalsDollarColored:case Fe.tao.sumTotalsDollarBold:a="sum";break;default:n=t.numberFormat}else if(l===Fe.PUO.number)switch(r.formatter){case Fe._tQ.multiple:if(Array.isArray(r.params?.formatters))for(const i of r.params.formatters){const{excelFormat:a}=Ne(e,t,{...r,formatter:i},s,o);if(a!==t.numberFormat){n=a;break}}n||(n=t.numberFormat);break;case Fe._tQ.currency:case Fe._tQ.decimal:case Fe._tQ.dollar:case Fe._tQ.dollarColored:case Fe._tQ.dollarColoredBold:case Fe._tQ.percent:case Fe._tQ.percentComplete:case Fe._tQ.percentCompleteBar:case Fe._tQ.percentCompleteBarWithText:case Fe._tQ.percentSymbol:i=$e(r,s,"cell");break;default:n=t.numberFormat}return n||!r.formatter&&!r.groupTotalsFormatter||(i=$e(r,s,o,a),t.hasOwnProperty(i)||(t[i]=e.createFormat({format:i})),n=t[i]),{excelFormat:n,groupType:a}}function Re(e){const[t,r,s,o,n,i,a,l]=e?.match(/^([^\d(-]*)([(]?)([^\d]*)([-]?[\w]]?[\d\s]*[.,\d]*[\d]*[^)\s%]?)([^\d.,)]*)([)]?)([^\d]*)$/i)||[],h=(n||"").replace(/1/g,"0").replace(/[2]/g,"#");return[Le(r??""),s??"",Le(o??""),h,Le(i??""),a??"",Le(l??"")].join("").replace(",",",")}function $e(e,t,r,s=""){let o="",n="",i="";const{minDecimal:a,maxDecimal:l,thousandSeparator:h}=function(e,t,r){let s;if("group"===r)switch(e.groupTotalsFormatter){case Fe.tao.avgTotalsCurrency:case Fe.tao.avgTotalsDollar:case Fe.tao.sumTotalsCurrency:case Fe.tao.sumTotalsCurrencyColored:case Fe.tao.sumTotalsDollar:case Fe.tao.sumTotalsDollarBold:case Fe.tao.sumTotalsDollarColored:case Fe.tao.sumTotalsDollarColoredBold:s="currency";break;case Fe.tao.avgTotalsPercentage:s="percent";break;case Fe.tao.avgTotals:case Fe.tao.minTotals:case Fe.tao.maxTotals:case Fe.tao.sumTotals:case Fe.tao.sumTotalsColored:case Fe.tao.sumTotalsBold:default:s="decimal"}else if(e.formatter===Fe._tQ.multiple&&Array.isArray(e.params?.formatters)){s="decimal";for(const t of e.params.formatters)if(s=Ie(t),"decimal"!==s)break}else s=Ie(e.formatter);return(0,Fe.TT_)(e,t,s,r)}(e,t,r),c=parseFloat(`${h?"2220":"0"}.${function(e,t){return Me("1",e)+Me("2",t-e)}(a,l)}`);return"group"===r&&e.groupTotalsFormatter?(n=(0,Te.stripTags)(e.groupTotalsFormatter({[s]:{[e.field]:c}},e,t)),i=(0,Te.stripTags)(e.groupTotalsFormatter({[s]:{[e.field]:-c}},e,t))):e.formatter&&(n=(0,Te.stripTags)(e.formatter(0,0,c,e,{},t)),i=(0,Te.stripTags)(e.formatter(0,0,-c,e,{},t))),n&&i&&(o=Re(n)+";"+Re(i)),o}function Le(e){return e?`"${e}"`:e}function Me(e,t){let r="";for(let s=0;s<t;s++)r+=e;return r}const ze={filename:"export",format:Fe.ptE.xlsx,htmlDecode:!0,useStreamingExport:!0};class Be{constructor(){this._fileFormat=Fe.ptE.xlsx,this._columnHeaders=[],this._hasColumnTitlePreHeader=!1,this._hasGroupedItems=!1,this._pubSubService=null,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},this.className="ExcelExportService"}get _datasetIdPropName(){return this._gridOptions?.datasetIdPropertyName??"id"}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()||{}}get stylesheet(){return this._stylesheet}get stylesheetFormats(){return this._stylesheetFormats}get groupTotalExcelFormats(){return this._groupTotalExcelFormats}get regularCellExcelFormats(){return this._regularCellExcelFormats}dispose(){this._pubSubService?.unsubscribeAll()}init(e,t){if(this._grid=e,this._pubSubService=t.get("PubSubService"),this._locales=this._gridOptions?.locales??Fe.YMJ.locales,this._translaterService=this._gridOptions?.translater,this._gridOptions.enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be passed in the "translater" Grid Options when "enableTranslate" is enabled. (example: this.gridOptions = { enableTranslate: true, translater: this.translaterService })')}exportToExcel(e){if(!this._grid||!this._dataView||!this._pubSubService)throw new Error('[Slickgrid-Universal] it seems that the SlickGrid & DataView objects and/or PubSubService are not initialized did you forget to enable the grid option flag "enableExcelExport"?');return new Promise((t=>{this._pubSubService?.publish("onBeforeExportToExcel",!0),this._excelExportOptions=(0,Te.extend)(!0,{},{...ze,...this._gridOptions.excelExportOptions,...e}),this._fileFormat=this._excelExportOptions.format||Fe.ptE.xlsx;const r=!!this._excelExportOptions.useStreamingExport;this._regularCellExcelFormats={},this._groupTotalExcelFormats={};const s={name:this._excelExportOptions.sheetName||"Sheet1"};this._workbook=new ve,this._sheet=this._workbook.createWorksheet(s),this._stylesheet=this._workbook.getStyleSheet();const o=this._stylesheet.createFormat({font:{bold:!0}}),n=this._stylesheet.createFormat({format:"@"}),i=this._stylesheet.createFormat({format:"0"});this._stylesheetFormats={boldFormat:o,numberFormat:i,stringFormat:n},this._sheet.setColumnFormats([o]),setTimeout((async()=>{const e=this.getDataOutput();this._gridOptions?.excelExportOptions?.customExcelHeader&&this._gridOptions.excelExportOptions.customExcelHeader(this._workbook,this._sheet);const s=this._grid?.getColumns()||[];this._sheet.setColumns(this.getColumnStyles(s));const o=this._sheet.data;let n=o;Array.isArray(o)&&Array.isArray(e)&&(n=this._sheet.data.concat(e)),this._sheet.setData(n),this._workbook.addWorksheet(this._sheet);let i=this._excelExportOptions?.mimeType;void 0===i&&(i=this._fileFormat===Fe.ptE.xls?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const a=`${this._excelExportOptions.filename}.${this._fileFormat}`;if(this._fileFormat===Fe.ptE.xlsx&&r)try{const e=function(e,t){const r=typeof window<"u"&&typeof window.ReadableStream<"u",s=typeof process<"u"&&process.versions?.node;if(r)return function(e,t){return new ReadableStream({async start(r){const s=await e.generateFiles(),o={};for(const[e,t]of Object.entries(s)){const r=e.startsWith("/")?e.substr(1):e;-1!==e.indexOf(".xml")||-1!==e.indexOf(".rel")?o[r]=Z(String(t)):o[r]=Ee(String(t))}const n=se(o,t?.zipOptions||{});let i=0;for(;i<n.length;){const e=n.subarray(i,i+65536);r.enqueue(e),i+=65536,await new Promise((e=>setTimeout(e,0)))}r.close()}})}(e,t);if(s)return async function*(e,t){const r=await e.generateFiles(),s={};for(const[e,t]of Object.entries(r)){const r=e.startsWith("/")?e.substr(1):e;-1!==e.indexOf(".xml")||-1!==e.indexOf(".rel")?s[r]=Z(String(t)):s[r]=Ee(String(t))}const o=se(s,t?.zipOptions||{});let n=0;for(;n<o.length;)yield o.subarray(n,n+65536),n+=65536,await new Promise((e=>setTimeout(e,0)))}(e,t);throw new Error("Streaming is only supported in browser or NodeJS environments.")}(this._workbook,{chunkSize:1e3}),r=[];for await(const t of e)r.push(t);const s=new Blob(r,{type:i}),o=URL.createObjectURL(s),n=(0,Te.createDomElement)("a",{href:o,download:a},document.body);n.click(),document.body.removeChild(n),URL.revokeObjectURL(o),this._pubSubService?.publish("onAfterExportToExcel",{filename:a,mimeType:i}),t(!0)}catch(e){this.legacyExcelExport(a,i,t)}else this.legacyExcelExport(a,i,t)}),50)}))}getExcelColumnNameByIndex(e){const t="ZABCDEFGHIJKLMNOPQRSTUVWXY";let r=Math.floor(e/26);const s=Math.floor(e%26);return 0===s&&r--,e>26?this.getExcelColumnNameByIndex(r)+t[s]:t[s]+""}getDataOutput(){const e=this._grid?.getColumns()||[],t=[],r=this._gridOptions?.excelExportOptions,s=r?.columnHeaderStyle;let o=this._stylesheetFormats.boldFormat.id;if(s&&(o=this._stylesheet.createFormat(s).id),this._gridOptions.createPreHeaderPanel&&this._gridOptions.showPreHeaderPanel&&!this._gridOptions.enableDraggableGrouping){const r=this._stylesheet.createFormat({alignment:{horizontal:"center"},font:{bold:!0}});t.push(this.getColumnGroupedHeaderTitlesData(e,{style:r?.id})),this._hasColumnTitlePreHeader=!0}return t.push(this.getColumnHeaderData(e,{style:o})),this.pushAllGridRowDataToArray(t,e),t}getColumnStyles(e){const t=this._dataView.getGrouping(),r=[];return Array.isArray(t)&&t.length>0&&r.push({bestFit:!0,columnStyles:this._gridOptions?.excelExportOptions?.customColumnWidth??10}),e.forEach((e=>{const t=e.excludeFromExport??!1;(void 0===e.width||e.width>0)&&!t&&r.push({bestFit:!0,width:e.excelExportOptions?.width??this._gridOptions?.excelExportOptions?.customColumnWidth??10})})),r}getColumnGroupedHeaderTitlesData(e,t){let r=[];this._groupedColumnHeaders=this.getColumnGroupedHeaderTitles(e)||[],this._groupedColumnHeaders&&Array.isArray(this._groupedColumnHeaders)&&this._groupedColumnHeaders.length>0&&(r=this._groupedColumnHeaders.map((e=>({value:e.title,metadata:t}))));let s=0;const o=this._groupedColumnHeaders.length;for(let e=0;e<o;e++)if(e+1===o||e+1<o&&this._groupedColumnHeaders[e].title!==this._groupedColumnHeaders[e+1].title){const t=this.getExcelColumnNameByIndex(s+1),r=this.getExcelColumnNameByIndex(e+1);this._sheet.mergeCells(`${t}1`,`${r}1`),s=e+1}return r}getColumnHeaderData(e,t){let r=[];this._columnHeaders=this.getColumnHeaders(e)||[],this._columnHeaders&&Array.isArray(this._columnHeaders)&&this._columnHeaders.length>0&&(r=this._columnHeaders.map((e=>({value:(0,Te.htmlDecode)((0,Te.stripTags)(e.title)),metadata:t}))));const s=this.getGroupColumnTitle();return s&&r.unshift({value:s,metadata:t}),r}getGroupColumnTitle(){let e=this._excelExportOptions.groupingColumnHeaderTitle;!e&&this._gridOptions.enableTranslate&&this._translaterService?.translate?e=this._translaterService.translate(`${(0,Fe.mVi)(this._gridOptions)}GROUP_BY`):e||(e=this._locales?.TEXT_GROUP_BY);const t=this._dataView.getGrouping();return Array.isArray(t)&&t.length>0?(this._hasGroupedItems=!0,e):(this._hasGroupedItems=!1,null)}getColumnGroupedHeaderTitles(e){const t=[];return Array.isArray(e)&&e.forEach((e=>{let r="";r=e.columnGroupKey&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(e.columnGroupKey):e.columnGroup||"";const s=e.excludeFromExport||!1;(void 0===e.width||e.width>0)&&!s&&t.push({key:e.field||e.id,title:r||""})})),t}getColumnHeaders(e){const t=[];return Array.isArray(e)&&e.forEach((e=>{let r="";r=(e.nameKey||e.nameKey)&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(e.nameKey||e.nameKey):(0,Te.getHtmlStringOutput)(e.name||"","innerHTML")||(0,Te.titleCase)(e.field);const s=e.excludeFromExport||!1;(void 0===e.width||e.width>0)&&!s&&t.push({key:(e.field||e.id)+"",title:r})})),t}pushAllGridRowDataToArray(e,t){const r=this._dataView.getLength();for(let s=0;s<r;s++){const r=this._dataView.getItem(s);r&&!r.hasOwnProperty("getItem")&&(null!==r[this._datasetIdPropName]&&void 0!==r[this._datasetIdPropName]?e.push(this.readRegularRowData(t,s,r,s)):this._hasGroupedItems&&void 0===r.__groupTotals?e.push([this.readGroupedRowTitle(r)]):r.__groupTotals&&e.push(this.readGroupedTotalRows(t,r,s)))}return e}readRegularRowData(e,t,r,s){let o=0;const n=[],i=e.length;let a=1,l=0;const h=this._dataView.getItemMetadata(t);for(let c=0;c<i;c++){const i=e[c];if(i.excludeFromExport)continue;this._hasGroupedItems&&0===o&&n.push("");let d=1;if(this._gridOptions.enableCellRowSpan){const e=this._grid.getParentRowSpanByCell(t,c,!1);if(e){if(e.start!==t){n.push("");continue}d=e.end-e.start+1}}let p,m=1;if(h?.columns){const t=h.columns,r=t[i.id]||t[c];!isNaN(a)&&+a>1||"*"===a&&c>0||(a=r?.colspan??1),"*"===a?m=e.length-c:(m=a,(i.id in t||c in t)&&(p=i.id,l=c))}if(d>1&&!isNaN(a)&&1===+a&&i.id===p){const e=t+(this._hasColumnTitlePreHeader?3:2),r=this.getExcelColumnNameByIndex(c+1),s=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`${r}${e}`,`${s}${e+d-1}`)}if("*"===a&&c>0||!isNaN(a)&&+a>1&&i.id!==p){const e=t+(this._hasColumnTitlePreHeader?3:2);if("number"==typeof a&&m-1==1){const t=this.getExcelColumnNameByIndex(l+1),r=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`${t}${e}`,`${r}${e+d-1}`),n.push("")}else if("*"===a&&1===m){const t=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`A${e}`,`${t}${e+d-1}`)}else n.push("");"number"==typeof a&&!isNaN(a)&&+a>1&&(m=a--)}else{let e="";const a=(0,Fe.lB_)(i),l={...this._excelExportOptions};if(!1!==i.exportWithFormatter&&(0,Fe.vsW)(a)&&(l.exportWithFormatter=!0),e=(0,Fe.qgn)(t,c,i,r,this._grid,l),!this._regularCellExcelFormats.hasOwnProperty(i.id)){const e=i.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat,t=Pe(this._stylesheet,this._stylesheetFormats,i,this._grid,e);i.excelExportOptions?.style&&(t.excelFormatId=this._stylesheet.createFormat(i.excelExportOptions.style).id),i.excelExportOptions?.valueParserCallback&&(t.getDataValueParser=i.excelExportOptions.valueParserCallback),this._regularCellExcelFormats[i.id]=t}"string"==typeof e&&((i.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(e=(0,Te.stripTags)(e)),this._excelExportOptions.htmlDecode&&(e=(0,Te.htmlDecode)(e)));const{excelFormatId:h,getDataValueParser:d}=this._regularCellExcelFormats[i.id];e=d(e,{columnDef:i,excelFormatId:h,stylesheet:this._stylesheet,gridOptions:this._gridOptions,dataRowIdx:s,dataContext:r}),n.push(e),o++}}return n}readGroupedRowTitle(e){const t=(0,Te.htmlDecode)((0,Te.stripTags)(e.title));if(this._excelExportOptions?.addGroupIndentation){const r=this._excelExportOptions?.groupCollapsedSymbol||"⮞",s=this._excelExportOptions?.groupExpandedSymbol||"⮟";return(e.collapsed?r:s)+" "+(0,Te.addWhiteSpaces)(5*e.level)+t}return t}readGroupedTotalRows(e,t,r){const s=[this._excelExportOptions.groupingAggregatorRowText||""];return e.forEach((e=>{let o="";const n=(0,Fe.lB_)(e),i=e.excludeFromExport||!1;if(e.exportCustomGroupTotalsFormatter){const r=e.exportCustomGroupTotalsFormatter(t,e,this._grid);o=r instanceof HTMLElement?r.textContent||"":r}const a=e.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat;if("number"===n&&!1!==a){let s=this._groupTotalExcelFormats[e.id];s?.groupType||(s=Ne(this._stylesheet,this._stylesheetFormats,e,this._grid,"group"),e.groupTotalsExcelExportOptions?.style&&(s.excelFormat=this._stylesheet.createFormat(e.groupTotalsExcelExportOptions.style)),this._groupTotalExcelFormats[e.id]=s);const n=e.groupTotalsExcelExportOptions?.valueParserCallback??De;if(void 0!==t[s.groupType]?.[e.field]){const i=n(t,{columnDef:e,groupType:s.groupType,excelFormatId:s.excelFormat?.id,stylesheet:this._stylesheet,dataRowIdx:r});o="object"==typeof i&&i.hasOwnProperty("metadata")?i:o={value:i,metadata:{style:s.excelFormat?.id}}}}else if(e.groupTotalsFormatter){const r=e.groupTotalsFormatter(t,e,this._grid);o=r instanceof HTMLElement?r.textContent||"":r}"string"==typeof o&&((e.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(o=(0,Te.stripTags)(o)),this._excelExportOptions.htmlDecode&&(o=(0,Te.htmlDecode)(o))),(void 0===e.width||e.width>0)&&!i&&s.push(o)})),s}legacyExcelExport(e,t,r){Se(this._workbook,e,{mimeType:t}).then((()=>{this._pubSubService?.publish("onAfterExportToExcel",{filename:e,mimeType:t}),r(!0)}))}}}}]);