(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"8XUx":function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return l}));i("5aBb");var o=i("MG25"),s=function(e,i,o,s){return new(o||(o=t))((function(t,n){function l(t){try{d(s.next(t))}catch(t){n(t)}}function a(t){try{d(s.throw(t))}catch(t){n(t)}}function d(e){var i;e.done?t(e.value):(i=e.value,i instanceof o?i:new o((function(t){t(i)}))).then(l,a)}d((s=s.apply(e,i||[])).next())}))};const n=t=>console.log(t.message);class l{constructor(){this._eventHandler=new Slick.EventHandler,this._bindEventService=new o.f}get eventHandler(){return this._eventHandler}get dataView(){return this.grid.getData()}get dataViewLength(){return this.dataView.getLength()}get formValues(){return this._formValues}get editors(){return this._editors}set editors(t){this._editors=t}get gridOptions(){var t;return null===(t=this.grid)||void 0===t?void 0:t.getOptions()}init(t,e){var i,s;if(this.grid=t,this.gridService=e.get("GridService"),this.gridStateService=e.get("GridStateService"),this.translaterService=e.get("TranslaterService"),!this.gridService||!this.gridStateService)throw new Error("[Slickgrid-Universal] it seems that the GridService and/or GridStateService are not being loaded properly, make sure the Container Service is properly implemented.");if(this.gridOptions.enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this._locales=null!==(s=null===(i=this.gridOptions)||void 0===i?void 0:i.locales)&&void 0!==s?s:o.t.locales}dispose(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this._formValues=null,this.disposeComponent()}disposeComponent(){var t;"function"==typeof(null===(t=this._modalElm)||void 0===t?void 0:t.remove)&&(this._modalElm.remove(),document.body.classList.remove("slick-modal-open"))}changeFormInputValue(t,e){var i,o,s;const n=null===(i=this._editors)||void 0===i?void 0:i[t];let l=e;if(!n)throw new Error(`Editor with column id "${t}" not found.`);if(n&&n.setValue&&Array.isArray(this._editorContainers)){n.setValue(e,!0);const i=this._editorContainers.find(e=>e.dataset.editorid===t);n.disabled?(l="",null===(s=null==i?void 0:i.classList)||void 0===s||s.remove("modified")):null===(o=null==i?void 0:i.classList)||void 0===o||o.add("modified"),this._formValues=Object.assign(Object.assign({},this._formValues),{[t]:l})}}changeFormEditorOption(t,e,i){var o;const s=null===(o=this._editors)||void 0===o?void 0:o[t];if(!(null==s?void 0:s.changeEditorOption))throw new Error(`Editor with column id "${t}" not found OR the Editor does not support "changeEditorOption" (current only available with AutoComplete, Date, MultipleSelect & SingleSelect Editors).`);s.changeEditorOption(e,i)}disableFormInput(t,e=!0){var i;const o=null===(i=this._editors)||void 0===i?void 0:i[t];(null==o?void 0:o.disable)&&Array.isArray(this._editorContainers)&&o.disable(e)}openDetails(t){var e,i,s,l,a,d,r,c,h,u,v,m,p,g,E;const b=null!==(e=t.onError)&&void 0!==e?e:n,C={backdrop:"static",showCloseButtonOutside:!0,viewColumnLayout:"auto",modalType:"edit"};try{if(!this.grid||this.grid.getEditorLock().isActive()&&!this.grid.getEditorLock().commitCurrentEdit())return null;this._options=Object.assign(Object.assign(Object.assign(Object.assign({},C),this.gridOptions.compositeEditorOptions),t),{labels:Object.assign(Object.assign({},null===(i=this.gridOptions.compositeEditorOptions)||void 0===i?void 0:i.labels),null==t?void 0:t.labels)}),this._options.backdrop=void 0!==t.backdrop?t.backdrop:"static";const e=this._options.viewColumnLayout||1,n=this.grid.getActiveCell(),u=null!==(s=null==n?void 0:n.cell)&&void 0!==s?s:0,v=null!==(l=null==n?void 0:n.row)&&void 0!==l?l:0,m=this.grid.getUID()||"";let p=t.headerTitle||"";if(this.hasRowSelectionEnabled()&&"auto-mass"===this._options.modalType&&this.grid.getSelectedRows){(this.grid.getSelectedRows()||[]).length>0?(this._options.modalType="mass-selection",(null==t?void 0:t.headerTitleMassSelection)&&(p=null==t?void 0:t.headerTitleMassSelection)):(this._options.modalType="mass-update",(null==t?void 0:t.headerTitleMassUpdate)&&(p=null==t?void 0:t.headerTitleMassUpdate))}const g=this._options.modalType||"edit";if(!this.gridOptions.editable)return b({type:"error",code:"EDITABLE_GRID_REQUIRED",message:"Your grid must be editable in order to use the Composite Editor Modal."}),null;if(!this.gridOptions.enableCellNavigation)return b({type:"error",code:"ENABLE_CELL_NAVIGATION_REQUIRED",message:'Composite Editor requires the flag "enableCellNavigation" to be set to True in your Grid Options.'}),null;if(!this.gridOptions.enableAddRow&&"create"===g)return b({type:"error",code:"ENABLE_ADD_ROW_REQUIRED",message:'Composite Editor requires the flag "enableAddRow" to be set to True in your Grid Options when creating a new item.'}),null;if(!n&&"edit"===g)return b({type:"warning",code:"NO_RECORD_FOUND",message:"No records selected for edit operation."}),null;{const t="mass-update"===g||"mass-selection"===g,i=t?{}:this.grid.getDataItem(v),s=this.grid.getColumns(),n=this.hasRowSelectionEnabled()?this.grid.getSelectedRows():[],l=null!==(d=null===(a=this.dataView)||void 0===a?void 0:a.getItems())&&void 0!==d?d:[],E=Array.isArray(l)?l.length:0;this._lastActiveRowNumber=v;const C=null===(r=this.gridStateService)||void 0===r?void 0:r.getCurrentRowSelections(),_=(null==C?void 0:C.dataContextIds)||[],y="create"===g?this.dataViewLength:v;if(!this.focusOnFirstColumnCellWithEditor(s,i,u,y,t))return null;if("edit"===g&&!i)return b({type:"warning",code:"ROW_NOT_EDITABLE",message:"Current row is not editable."}),null;if("mass-selection"===g&&n.length<1)return b({type:"warning",code:"ROW_SELECTION_REQUIRED",message:"You must select some rows before trying to apply new value(s)."}),null;let S=[];S=t?s.filter(t=>{var e;return t.editor&&!0===(null===(e=t.internalColumnEditor)||void 0===e?void 0:e.massUpdate)}):s.filter(t=>t.editor);const f=p.replace(/\{\{(.*?)\}\}/g,(t,e)=>Object(o.Ic)(i,e)),w=Object(o.sd)(this.gridOptions,f),O="auto"===e?this.autoCalculateLayoutColumnCount(S.length):e;this._modalElm=document.createElement("div"),this._modalElm.className="slick-editor-modal "+m;const T=document.createElement("div");if(T.className="slick-editor-modal-content",e>1||"auto"===e&&O>1){const t=2===O?"split-view":"triple-split-view";T.classList.add(t)}const L=document.createElement("div");L.className="slick-editor-modal-title",L.innerHTML=w;const A=document.createElement("button");A.type="button",A.textContent="Ã—",A.className="close",A.dataset.action="close",A.dataset.ariaLabel="Close",this._options.showCloseButtonOutside&&(null===(c=null==L?void 0:L.classList)||void 0===c||c.add("outside"),null===(h=null==A?void 0:A.classList)||void 0===h||h.add("outside"));const x=document.createElement("div");x.className="slick-editor-modal-header",x.appendChild(L),x.appendChild(A);const k=document.createElement("div");k.className="slick-editor-modal-body",this._modalBodyTopValidationElm=document.createElement("div"),this._modalBodyTopValidationElm.className="validation-summary",this._modalBodyTopValidationElm.style.display="none",k.appendChild(this._modalBodyTopValidationElm);const N=document.createElement("div");N.className="slick-editor-modal-footer";const V=document.createElement("button");V.type="button",V.className="btn btn-cancel btn-default btn-sm",V.dataset.action="cancel",V.dataset.ariaLabel=this.getLabelText("cancelButton","TEXT_CANCEL","Cancel"),V.textContent=this.getLabelText("cancelButton","TEXT_CANCEL","Cancel");let I="",R="";switch(g){case"mass-update":const t=this.getLabelText("massUpdateStatus","TEXT_ALL_X_RECORDS_SELECTED","All {{x}} records selected");I=this.parseText(t,{x:E}),R=this.getLabelText("massUpdateButton","TEXT_APPLY_MASS_UPDATE","Mass Update");break;case"mass-selection":const e=this.getLabelText("massSelectionStatus","TEXT_X_OF_Y_MASS_SELECTED","{{x}} of {{y}} selected");I=this.parseText(e,{x:_.length,y:E}),R=this.getLabelText("massSelectionButton","TEXT_APPLY_TO_SELECTION","Update Selection");break;default:R=this.getLabelText("saveButton","TEXT_SAVE","Save")}const B=document.createElement("div");B.className="footer-status-text",B.textContent=I,this._modalSaveButtonElm=document.createElement("button"),this._modalSaveButtonElm.type="button",this._modalSaveButtonElm.className="btn btn-save btn-primary btn-sm",this._modalSaveButtonElm.dataset.action="create"===g||"edit"===g?"save":g,this._modalSaveButtonElm.dataset.ariaLabel=R,this._modalSaveButtonElm.textContent=R;const D=document.createElement("div");D.className="footer-buttons","mass-update"!==g&&"mass-selection"!==g||N.appendChild(B),D.appendChild(V),D.appendChild(this._modalSaveButtonElm),N.appendChild(D),T.appendChild(x),T.appendChild(k),T.appendChild(N),this._modalElm.appendChild(T);for(const t of S)if(t.editor){const e=document.createElement("div");e.className="item-details-container editor-"+t.id,1===O?e.classList.add("slick-col-medium-12"):e.classList.add("slick-col-medium-6","slick-col-xlarge-"+12/O);const i=document.createElement("div");i.className="item-details-label editor-"+t.id,i.textContent=this.getColumnLabel(t)||"n/a";const o=document.createElement("div");o.className="item-details-editor-container slick-cell",o.dataset.editorid=""+t.id;const s=document.createElement("div");s.className="item-details-validation editor-"+t.id,e.appendChild(i),e.appendChild(o),e.appendChild(s),k.appendChild(e)}document.body.appendChild(this._modalElm),document.body.classList.add("slick-modal-open"),this._bindEventService.bind(document.body,"click",this.handleBodyClicked.bind(this)),this._editors={},this._editorContainers=S.map(t=>k.querySelector(`[data-editorid=${t.id}]`))||[];const U={destroy:this.disposeComponent.bind(this),modalType:g,validationMsgPrefix:"* ",formValues:{},editors:this._editors},M=new Slick.CompositeEditor(S,this._editorContainers,U);this.grid.editActiveCell(M),this._bindEventService.bind(A,"click",this.cancelEditing.bind(this)),this._bindEventService.bind(V,"click",this.cancelEditing.bind(this)),this._bindEventService.bind(this._modalSaveButtonElm,"click",this.handleSaveClicked.bind(this)),this._bindEventService.bind(this._modalElm,"keydown",this.handleKeyDown.bind(this)),this._bindEventService.bind(this._modalElm,"focusout",this.validateCurrentEditor.bind(this)),this._bindEventService.bind(this._modalElm,"blur",this.validateCurrentEditor.bind(this));const P=this.grid.onCompositeEditorChange;this._eventHandler.subscribe(P,this.handleOnCompositeEditorChange.bind(this));const j=this.grid.onAddNewRow;this._eventHandler.subscribe(j,this.handleOnAddNewRow.bind(this))}return this}catch(t){this.dispose();const e="string"==typeof t?t:null!==(m=null!==(u=null==t?void 0:t.message)&&void 0!==u?u:null===(v=null==t?void 0:t.body)||void 0===v?void 0:v.message)&&void 0!==m?m:"";return b({type:"error",code:"string"==typeof t?t:null!==(E=null!==(p=null==t?void 0:t.status)&&void 0!==p?p:null===(g=null==t?void 0:t.body)||void 0===g?void 0:g.status)&&void 0!==E?E:e,message:e}),null}}applySaveMassUpdateChanges(t){const e=this.dataView.getItems();for(const i in t)t.hasOwnProperty(i)&&e.forEach(e=>{t.hasOwnProperty(i)&&(e[i]=t[i])});this.dataView.setItems(e,this.gridOptions.datasetIdPropertyName),this.grid.invalidate()}applySaveMassSelectionChanges(t,e){var i,o;const s=(null!==(i=null==e?void 0:e.dataContextIds)&&void 0!==i?i:[]).map(t=>this.dataView.getItemById(t));for(const e in t)t.hasOwnProperty(e)&&s.forEach(i=>{i&&i.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(i[e]=t[e])});null===(o=this.gridService)||void 0===o||o.updateItems(s)}cancelEditing(){return s(this,void 0,void 0,(function*(){let t=!0;this.formValues&&Object.keys(this.formValues).length>0&&"function"==typeof this._options.onClose&&(t=yield this._options.onClose()),t&&(this.grid.getEditController().cancelCurrentEdit(),this.grid.setActiveRow(this._lastActiveRowNumber),this.dispose())}))}handleSaveClicked(){var t;const e=null===(t=this._options)||void 0===t?void 0:t.modalType;switch(e){case"mass-update":this.handleMassSaving(e,()=>{this.grid.getEditController().cancelCurrentEdit(),this.grid.setActiveCell(0,0,!1),this.dispose()});break;case"mass-selection":this.handleMassSaving(e,()=>{this.grid.getEditController().cancelCurrentEdit(),this.grid.setActiveRow(this._lastActiveRowNumber),this.dispose()});break;case"create":case"edit":default:this.grid.getEditController().commitCurrentEdit()}}handleMassSaving(t,e){var i,o,n,l,a,d;return s(this,void 0,void 0,(function*(){const s=this.validateCompositeEditors().valid;this.showValidationSummaryText(!1,"");const r="mass-update"===t?"applySaveMassUpdateChanges":"applySaveMassSelectionChanges";try{if("function"==typeof this[r])if(this.formValues&&0!==Object.keys(this.formValues).length){if(s&&this.formValues){this._modalSaveButtonElm.classList.add("saving"),this._modalSaveButtonElm.disabled=!0;const t=null===(i=this.gridStateService)||void 0===i?void 0:i.getCurrentRowSelections(),s=(null==t?void 0:t.gridRowIndexes)||[],l=(null==t?void 0:t.dataContextIds)||[];if("function"==typeof(null===(o=this._options)||void 0===o?void 0:o.onSave)){(yield null===(n=this._options)||void 0===n?void 0:n.onSave(this.formValues,{gridRowIndexes:s,dataContextIds:l},this[r].bind(this)))&&e()}else this[r](this.formValues,{gridRowIndexes:s,dataContextIds:l}),e(),this.dispose();this._modalSaveButtonElm.disabled=!1,this._modalSaveButtonElm.classList.remove("saving")}}else this.executeOnError({type:"warning",code:"NO_CHANGES_DETECTED",message:"Sorry we could not detect any changes."})}catch(t){const e="string"==typeof t?t:null!==(d=null!==(l=null==t?void 0:t.message)&&void 0!==l?l:null===(a=null==t?void 0:t.body)||void 0===a?void 0:a.message)&&void 0!==d?d:"";this.showValidationSummaryText(!0,e)}}))}showValidationSummaryText(t,e=""){var i,o;t?(this._modalBodyTopValidationElm.textContent=e,this._modalBodyTopValidationElm.style.display="block",null===(o=(i=this._modalBodyTopValidationElm).scrollIntoView)||void 0===o||o.call(i),this._modalSaveButtonElm.disabled=!1,this._modalSaveButtonElm.classList.remove("saving")):(this._modalBodyTopValidationElm.style.display="none",this._modalBodyTopValidationElm.textContent=e)}validateCurrentEditor(){const t=this.grid.getCellEditor();(null==t?void 0:t.validate)&&t.validate()}autoCalculateLayoutColumnCount(t){return t>=15?3:t>=8?2:1}executeOnError(t){var e,i;(null!==(i=null===(e=this._options)||void 0===e?void 0:e.onError)&&void 0!==i?i:n)(t)}getColumnLabel(t){var e;const i=this.gridOptions.columnGroupSeparator||" - ";let o=t.name||"",s=t.columnGroup||"";this.gridOptions.enableTranslate&&this.translaterService&&(t.nameKey&&(o=this.translaterService.translate(t.nameKey)),t.columnGroupKey&&(null===(e=this.translaterService)||void 0===e?void 0:e.translate)&&(s=this.translaterService.translate(t.columnGroupKey)));return(s?`${s}${i}${o}`:o)||""}handleBodyClicked(t){var e,i,o;(null===(i=null===(e=t.target)||void 0===e?void 0:e.classList)||void 0===i?void 0:i.contains("slick-editor-modal"))&&"static"!==(null===(o=this._options)||void 0===o?void 0:o.backdrop)&&this.dispose()}handleKeyDown(t){"Escape"===t.code?(this.cancelEditing(),t.stopPropagation(),t.preventDefault()):"Tab"===t.code&&this.validateCurrentEditor()}focusOnFirstColumnCellWithEditor(t,e,i,o,s){let n=i;if(!t[i].editor||!this.getActiveCellEditor(o,i)){if(n=this.findNextAvailableEditorColumnIndex(t,e,o,s),-1===n)return this.executeOnError({type:"error",code:"NO_EDITOR_FOUND",message:"We could not find any Editor in your Column Definition"}),!1;this.grid.setActiveCell(o,n,!1),s&&this.grid.setActiveRow(this.dataViewLength,n,!0)}return!0}findNextAvailableEditorColumnIndex(t,e,i,o){var s;let n=-1;for(let l=0;l<t.length;l++){const a=t[l];if(a.editor&&(!o||o&&(null===(s=a.internalColumnEditor)||void 0===s?void 0:s.massUpdate))){const t=this.grid.onBeforeEditCell.notify({row:i,cell:l,item:e,column:a,grid:this.grid});if(this.grid.setActiveCell(i,l,!1),!1!==t){n=l;break}}}return n}getActiveCellEditor(t,e){return this.grid.setActiveCell(t,e,!1),this.grid.getCellEditor()}getLabelText(t,e,i){var o,s,n,l;const a=Object.assign(Object.assign({},null===(o=this.gridOptions.compositeEditorOptions)||void 0===o?void 0:o.labels),null===(s=this._options)||void 0===s?void 0:s.labels);if((null===(n=this.gridOptions)||void 0===n?void 0:n.enableTranslate)&&(null===(l=this.translaterService)||void 0===l?void 0:l.translate)&&a.hasOwnProperty(t+"Key")){const e=a[t+"Key"];return this.translaterService.translate(e)}return a&&a[t]||this._locales&&this._locales[e]||i}handleOnAddNewRow(t,e){var i,o,s,n;const l=null!==(o=null===(i=this.dataView)||void 0===i?void 0:i.getItems())&&void 0!==o?o:[],a=Array.isArray(l)?l.length:0,d=null!==(s=this._options.insertNewId)&&void 0!==s?s:a+1,r=e.item;r[this.gridOptions.datasetIdPropertyName||"id"]=d,this.dataView.getItemById(d)||(null===(n=this.gridService)||void 0===n||n.addItem(r,this._options.insertOptions),this.dispose())}handleOnCompositeEditorChange(t,e){var i,o,s,n,l;const a=null!==(o=null===(i=e.column)||void 0===i?void 0:i.id)&&void 0!==o?o:"";this._formValues=e.formValues;const d=null===(s=this._editors)||void 0===s?void 0:s[a],r=null!==(l=null===(n=null==d?void 0:d.isValueChanged)||void 0===n?void 0:n.call(d))&&void 0!==l&&l,c=document.querySelector(`[data-editorid=${a}]`);(null==c?void 0:c.classList)&&(r?c.classList.add("modified"):c.classList.remove("modified")),this.validateCompositeEditors()}hasRowSelectionEnabled(){const t=this.grid.getSelectionModel();return(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector)&&t}parseText(t,e){return t.replace(/\{\{(.*?)\}\}/g,(t,i)=>void 0!==e[i]?e[i]:t)}validateCompositeEditors(t){let e={valid:!0,msg:""};const i=this.grid.getCellEditor();return i&&(e=i.validate(t)),e}}}).call(this,i("CW7D"))},Lavn:function(t,e,i){"use strict";var o=i("8XUx");i.d(e,"a",(function(){return o.a}))}}]);
//# sourceMappingURL=vendors~cacac4fb.c3fd8917e1e1bf9edad5.bundle.map